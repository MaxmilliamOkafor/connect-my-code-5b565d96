function sr(t){return t==null||typeof t=="function"?{main:t}:t}function ln(t,e){return function(){return t.apply(e,arguments)}}const{toString:ir}=Object.prototype,{getPrototypeOf:ht}=Object,xe=(t=>e=>{const n=ir.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),x=t=>(t=t.toLowerCase(),e=>xe(e)===t),ke=t=>e=>typeof e===t,{isArray:re}=Array,ce=ke("undefined");function or(t){return t!==null&&!ce(t)&&t.constructor!==null&&!ce(t.constructor)&&O(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const dn=x("ArrayBuffer");function ar(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&dn(t.buffer),e}const cr=ke("string"),O=ke("function"),fn=ke("number"),Ne=t=>t!==null&&typeof t=="object",ur=t=>t===!0||t===!1,be=t=>{if(xe(t)!=="object")return!1;const e=ht(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},lr=x("Date"),dr=x("File"),fr=x("Blob"),hr=x("FileList"),pr=t=>Ne(t)&&O(t.pipe),mr=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||O(t.append)&&((e=xe(t))==="formdata"||e==="object"&&O(t.toString)&&t.toString()==="[object FormData]"))},gr=x("URLSearchParams"),[yr,_r,br,Sr]=["ReadableStream","Request","Response","Headers"].map(x),wr=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function le(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let r,s;if(typeof t!="object"&&(t=[t]),re(t))for(r=0,s=t.length;r<s;r++)e.call(null,t[r],r,t);else{const i=n?Object.getOwnPropertyNames(t):Object.keys(t),o=i.length;let a;for(r=0;r<o;r++)a=i[r],e.call(null,t[a],a,t)}}function hn(t,e){e=e.toLowerCase();const n=Object.keys(t);let r=n.length,s;for(;r-- >0;)if(s=n[r],e===s.toLowerCase())return s;return null}const pn=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,mn=t=>!ce(t)&&t!==pn;function Xe(){const{caseless:t}=mn(this)&&this||{},e={},n=(r,s)=>{const i=t&&hn(e,s)||s;be(e[i])&&be(r)?e[i]=Xe(e[i],r):be(r)?e[i]=Xe({},r):re(r)?e[i]=r.slice():e[i]=r};for(let r=0,s=arguments.length;r<s;r++)arguments[r]&&le(arguments[r],n);return e}const Er=(t,e,n,{allOwnKeys:r}={})=>(le(e,(s,i)=>{n&&O(s)?t[i]=ln(s,n):t[i]=s},{allOwnKeys:r}),t),vr=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),Tr=(t,e,n,r)=>{t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},Cr=(t,e,n,r)=>{let s,i,o;const a={};if(e=e||{},t==null)return e;do{for(s=Object.getOwnPropertyNames(t),i=s.length;i-- >0;)o=s[i],(!r||r(o,t,e))&&!a[o]&&(e[o]=t[o],a[o]=!0);t=n!==!1&&ht(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},Ar=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const r=t.indexOf(e,n);return r!==-1&&r===n},Rr=t=>{if(!t)return null;if(re(t))return t;let e=t.length;if(!fn(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},Pr=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&ht(Uint8Array)),Or=(t,e)=>{const r=(t&&t[Symbol.iterator]).call(t);let s;for(;(s=r.next())&&!s.done;){const i=s.value;e.call(t,i[0],i[1])}},Ir=(t,e)=>{let n;const r=[];for(;(n=t.exec(e))!==null;)r.push(n);return r},xr=x("HTMLFormElement"),kr=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,s){return r.toUpperCase()+s}),At=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),Nr=x("RegExp"),gn=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),r={};le(n,(s,i)=>{let o;(o=e(s,i,t))!==!1&&(r[i]=o||s)}),Object.defineProperties(t,r)},Dr=t=>{gn(t,(e,n)=>{if(O(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=t[n];if(O(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},Lr=(t,e)=>{const n={},r=s=>{s.forEach(i=>{n[i]=!0})};return re(t)?r(t):r(String(t).split(e)),n},Ur=()=>{},Fr=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e,He="abcdefghijklmnopqrstuvwxyz",Rt="0123456789",yn={DIGIT:Rt,ALPHA:He,ALPHA_DIGIT:He+He.toUpperCase()+Rt},Mr=(t=16,e=yn.ALPHA_DIGIT)=>{let n="";const{length:r}=e;for(;t--;)n+=e[Math.random()*r|0];return n};function $r(t){return!!(t&&O(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const Br=t=>{const e=new Array(10),n=(r,s)=>{if(Ne(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[s]=r;const i=re(r)?[]:{};return le(r,(o,a)=>{const l=n(o,s+1);!ce(l)&&(i[a]=l)}),e[s]=void 0,i}}return r};return n(t,0)},jr=x("AsyncFunction"),Hr=t=>t&&(Ne(t)||O(t))&&O(t.then)&&O(t.catch),d={isArray:re,isArrayBuffer:dn,isBuffer:or,isFormData:mr,isArrayBufferView:ar,isString:cr,isNumber:fn,isBoolean:ur,isObject:Ne,isPlainObject:be,isReadableStream:yr,isRequest:_r,isResponse:br,isHeaders:Sr,isUndefined:ce,isDate:lr,isFile:dr,isBlob:fr,isRegExp:Nr,isFunction:O,isStream:pr,isURLSearchParams:gr,isTypedArray:Pr,isFileList:hr,forEach:le,merge:Xe,extend:Er,trim:wr,stripBOM:vr,inherits:Tr,toFlatObject:Cr,kindOf:xe,kindOfTest:x,endsWith:Ar,toArray:Rr,forEachEntry:Or,matchAll:Ir,isHTMLForm:xr,hasOwnProperty:At,hasOwnProp:At,reduceDescriptors:gn,freezeMethods:Dr,toObjectSet:Lr,toCamelCase:kr,noop:Ur,toFiniteNumber:Fr,findKey:hn,global:pn,isContextDefined:mn,ALPHABET:yn,generateString:Mr,isSpecCompliantForm:$r,toJSONObject:Br,isAsyncFn:jr,isThenable:Hr};function y(t,e,n,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),r&&(this.request=r),s&&(this.response=s)}d.inherits(y,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:d.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const _n=y.prototype,bn={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{bn[t]={value:t}});Object.defineProperties(y,bn);Object.defineProperty(_n,"isAxiosError",{value:!0});y.from=(t,e,n,r,s,i)=>{const o=Object.create(_n);return d.toFlatObject(t,o,function(l){return l!==Error.prototype},a=>a!=="isAxiosError"),y.call(o,t.message,e,n,r,s),o.cause=t,o.name=t.name,i&&Object.assign(o,i),o};const Kr=null;function Ye(t){return d.isPlainObject(t)||d.isArray(t)}function Sn(t){return d.endsWith(t,"[]")?t.slice(0,-2):t}function Pt(t,e,n){return t?t.concat(e).map(function(s,i){return s=Sn(s),!n&&i?"["+s+"]":s}).join(n?".":""):e}function qr(t){return d.isArray(t)&&!t.some(Ye)}const Jr=d.toFlatObject(d,{},null,function(e){return/^is[A-Z]/.test(e)});function De(t,e,n){if(!d.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=d.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(p,E){return!d.isUndefined(E[p])});const r=n.metaTokens,s=n.visitor||c,i=n.dots,o=n.indexes,l=(n.Blob||typeof Blob<"u"&&Blob)&&d.isSpecCompliantForm(e);if(!d.isFunction(s))throw new TypeError("visitor must be a function");function u(h){if(h===null)return"";if(d.isDate(h))return h.toISOString();if(!l&&d.isBlob(h))throw new y("Blob is not supported. Use a Buffer instead.");return d.isArrayBuffer(h)||d.isTypedArray(h)?l&&typeof Blob=="function"?new Blob([h]):Buffer.from(h):h}function c(h,p,E){let v=h;if(h&&!E&&typeof h=="object"){if(d.endsWith(p,"{}"))p=r?p:p.slice(0,-2),h=JSON.stringify(h);else if(d.isArray(h)&&qr(h)||(d.isFileList(h)||d.endsWith(p,"[]"))&&(v=d.toArray(h)))return p=Sn(p),v.forEach(function(b,U){!(d.isUndefined(b)||b===null)&&e.append(o===!0?Pt([p],U,i):o===null?p:p+"[]",u(b))}),!1}return Ye(h)?!0:(e.append(Pt(E,p,i),u(h)),!1)}const f=[],_=Object.assign(Jr,{defaultVisitor:c,convertValue:u,isVisitable:Ye});function m(h,p){if(!d.isUndefined(h)){if(f.indexOf(h)!==-1)throw Error("Circular reference detected in "+p.join("."));f.push(h),d.forEach(h,function(v,C){(!(d.isUndefined(v)||v===null)&&s.call(e,v,d.isString(C)?C.trim():C,p,_))===!0&&m(v,p?p.concat(C):[C])}),f.pop()}}if(!d.isObject(t))throw new TypeError("data must be an object");return m(t),e}function Ot(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function pt(t,e){this._pairs=[],t&&De(t,this,e)}const wn=pt.prototype;wn.append=function(e,n){this._pairs.push([e,n])};wn.toString=function(e){const n=e?function(r){return e.call(this,r,Ot)}:Ot;return this._pairs.map(function(s){return n(s[0])+"="+n(s[1])},"").join("&")};function Wr(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function En(t,e,n){if(!e)return t;const r=n&&n.encode||Wr,s=n&&n.serialize;let i;if(s?i=s(e,n):i=d.isURLSearchParams(e)?e.toString():new pt(e,n).toString(r),i){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+i}return t}class It{constructor(){this.handlers=[]}use(e,n,r){return this.handlers.push({fulfilled:e,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){d.forEach(this.handlers,function(r){r!==null&&e(r)})}}const vn={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},zr=typeof URLSearchParams<"u"?URLSearchParams:pt,Vr=typeof FormData<"u"?FormData:null,Gr=typeof Blob<"u"?Blob:null,Xr={isBrowser:!0,classes:{URLSearchParams:zr,FormData:Vr,Blob:Gr},protocols:["http","https","file","blob","url","data"]},mt=typeof window<"u"&&typeof document<"u",Yr=(t=>mt&&["ReactNative","NativeScript","NS"].indexOf(t)<0)(typeof navigator<"u"&&navigator.product),Qr=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Zr=mt&&window.location.href||"http://localhost",es=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:mt,hasStandardBrowserEnv:Yr,hasStandardBrowserWebWorkerEnv:Qr,origin:Zr},Symbol.toStringTag,{value:"Module"})),I={...es,...Xr};function ts(t,e){return De(t,new I.classes.URLSearchParams,Object.assign({visitor:function(n,r,s,i){return I.isNode&&d.isBuffer(n)?(this.append(r,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},e))}function ns(t){return d.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function rs(t){const e={},n=Object.keys(t);let r;const s=n.length;let i;for(r=0;r<s;r++)i=n[r],e[i]=t[i];return e}function Tn(t){function e(n,r,s,i){let o=n[i++];if(o==="__proto__")return!0;const a=Number.isFinite(+o),l=i>=n.length;return o=!o&&d.isArray(s)?s.length:o,l?(d.hasOwnProp(s,o)?s[o]=[s[o],r]:s[o]=r,!a):((!s[o]||!d.isObject(s[o]))&&(s[o]=[]),e(n,r,s[o],i)&&d.isArray(s[o])&&(s[o]=rs(s[o])),!a)}if(d.isFormData(t)&&d.isFunction(t.entries)){const n={};return d.forEachEntry(t,(r,s)=>{e(ns(r),s,n,0)}),n}return null}function ss(t,e,n){if(d.isString(t))try{return(e||JSON.parse)(t),d.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(t)}const de={transitional:vn,adapter:["xhr","http","fetch"],transformRequest:[function(e,n){const r=n.getContentType()||"",s=r.indexOf("application/json")>-1,i=d.isObject(e);if(i&&d.isHTMLForm(e)&&(e=new FormData(e)),d.isFormData(e))return s?JSON.stringify(Tn(e)):e;if(d.isArrayBuffer(e)||d.isBuffer(e)||d.isStream(e)||d.isFile(e)||d.isBlob(e)||d.isReadableStream(e))return e;if(d.isArrayBufferView(e))return e.buffer;if(d.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return ts(e,this.formSerializer).toString();if((a=d.isFileList(e))||r.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return De(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return i||s?(n.setContentType("application/json",!1),ss(e)):e}],transformResponse:[function(e){const n=this.transitional||de.transitional,r=n&&n.forcedJSONParsing,s=this.responseType==="json";if(d.isResponse(e)||d.isReadableStream(e))return e;if(e&&d.isString(e)&&(r&&!this.responseType||s)){const o=!(n&&n.silentJSONParsing)&&s;try{return JSON.parse(e)}catch(a){if(o)throw a.name==="SyntaxError"?y.from(a,y.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:I.classes.FormData,Blob:I.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};d.forEach(["delete","get","head","post","put","patch"],t=>{de.headers[t]={}});const is=d.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),os=t=>{const e={};let n,r,s;return t&&t.split(`
`).forEach(function(o){s=o.indexOf(":"),n=o.substring(0,s).trim().toLowerCase(),r=o.substring(s+1).trim(),!(!n||e[n]&&is[n])&&(n==="set-cookie"?e[n]?e[n].push(r):e[n]=[r]:e[n]=e[n]?e[n]+", "+r:r)}),e},xt=Symbol("internals");function ie(t){return t&&String(t).trim().toLowerCase()}function Se(t){return t===!1||t==null?t:d.isArray(t)?t.map(Se):String(t)}function as(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(t);)e[r[1]]=r[2];return e}const cs=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function Ke(t,e,n,r,s){if(d.isFunction(r))return r.call(this,e,n);if(s&&(e=n),!!d.isString(e)){if(d.isString(r))return e.indexOf(r)!==-1;if(d.isRegExp(r))return r.test(e)}}function us(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,r)=>n.toUpperCase()+r)}function ls(t,e){const n=d.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+n,{value:function(s,i,o){return this[r].call(this,e,s,i,o)},configurable:!0})})}let R=class{constructor(e){e&&this.set(e)}set(e,n,r){const s=this;function i(a,l,u){const c=ie(l);if(!c)throw new Error("header name must be a non-empty string");const f=d.findKey(s,c);(!f||s[f]===void 0||u===!0||u===void 0&&s[f]!==!1)&&(s[f||l]=Se(a))}const o=(a,l)=>d.forEach(a,(u,c)=>i(u,c,l));if(d.isPlainObject(e)||e instanceof this.constructor)o(e,n);else if(d.isString(e)&&(e=e.trim())&&!cs(e))o(os(e),n);else if(d.isHeaders(e))for(const[a,l]of e.entries())i(l,a,r);else e!=null&&i(n,e,r);return this}get(e,n){if(e=ie(e),e){const r=d.findKey(this,e);if(r){const s=this[r];if(!n)return s;if(n===!0)return as(s);if(d.isFunction(n))return n.call(this,s,r);if(d.isRegExp(n))return n.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=ie(e),e){const r=d.findKey(this,e);return!!(r&&this[r]!==void 0&&(!n||Ke(this,this[r],r,n)))}return!1}delete(e,n){const r=this;let s=!1;function i(o){if(o=ie(o),o){const a=d.findKey(r,o);a&&(!n||Ke(r,r[a],a,n))&&(delete r[a],s=!0)}}return d.isArray(e)?e.forEach(i):i(e),s}clear(e){const n=Object.keys(this);let r=n.length,s=!1;for(;r--;){const i=n[r];(!e||Ke(this,this[i],i,e,!0))&&(delete this[i],s=!0)}return s}normalize(e){const n=this,r={};return d.forEach(this,(s,i)=>{const o=d.findKey(r,i);if(o){n[o]=Se(s),delete n[i];return}const a=e?us(i):String(i).trim();a!==i&&delete n[i],n[a]=Se(s),r[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return d.forEach(this,(r,s)=>{r!=null&&r!==!1&&(n[s]=e&&d.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const r=new this(e);return n.forEach(s=>r.set(s)),r}static accessor(e){const r=(this[xt]=this[xt]={accessors:{}}).accessors,s=this.prototype;function i(o){const a=ie(o);r[a]||(ls(s,o),r[a]=!0)}return d.isArray(e)?e.forEach(i):i(e),this}};R.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);d.reduceDescriptors(R.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(r){this[n]=r}}});d.freezeMethods(R);function qe(t,e){const n=this||de,r=e||n,s=R.from(r.headers);let i=r.data;return d.forEach(t,function(a){i=a.call(n,i,s.normalize(),e?e.status:void 0)}),s.normalize(),i}function Cn(t){return!!(t&&t.__CANCEL__)}function se(t,e,n){y.call(this,t??"canceled",y.ERR_CANCELED,e,n),this.name="CanceledError"}d.inherits(se,y,{__CANCEL__:!0});function An(t,e,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?t(n):e(new y("Request failed with status code "+n.status,[y.ERR_BAD_REQUEST,y.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function ds(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function fs(t,e){t=t||10;const n=new Array(t),r=new Array(t);let s=0,i=0,o;return e=e!==void 0?e:1e3,function(l){const u=Date.now(),c=r[i];o||(o=u),n[s]=l,r[s]=u;let f=i,_=0;for(;f!==s;)_+=n[f++],f=f%t;if(s=(s+1)%t,s===i&&(i=(i+1)%t),u-o<e)return;const m=c&&u-c;return m?Math.round(_*1e3/m):void 0}}function hs(t,e){let n=0;const r=1e3/e;let s=null;return function(){const o=this===!0,a=Date.now();if(o||a-n>r)return s&&(clearTimeout(s),s=null),n=a,t.apply(null,arguments);s||(s=setTimeout(()=>(s=null,n=Date.now(),t.apply(null,arguments)),r-(a-n)))}}const Te=(t,e,n=3)=>{let r=0;const s=fs(50,250);return hs(i=>{const o=i.loaded,a=i.lengthComputable?i.total:void 0,l=o-r,u=s(l),c=o<=a;r=o;const f={loaded:o,total:a,progress:a?o/a:void 0,bytes:l,rate:u||void 0,estimated:u&&a&&c?(a-o)/u:void 0,event:i,lengthComputable:a!=null};f[e?"download":"upload"]=!0,t(f)},n)},ps=I.hasStandardBrowserEnv?(function(){const e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");let r;function s(i){let o=i;return e&&(n.setAttribute("href",o),o=n.href),n.setAttribute("href",o),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return r=s(window.location.href),function(o){const a=d.isString(o)?s(o):o;return a.protocol===r.protocol&&a.host===r.host}})():(function(){return function(){return!0}})(),ms=I.hasStandardBrowserEnv?{write(t,e,n,r,s,i){const o=[t+"="+encodeURIComponent(e)];d.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),d.isString(r)&&o.push("path="+r),d.isString(s)&&o.push("domain="+s),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function gs(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function ys(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function Rn(t,e){return t&&!gs(e)?ys(t,e):e}const kt=t=>t instanceof R?{...t}:t;function V(t,e){e=e||{};const n={};function r(u,c,f){return d.isPlainObject(u)&&d.isPlainObject(c)?d.merge.call({caseless:f},u,c):d.isPlainObject(c)?d.merge({},c):d.isArray(c)?c.slice():c}function s(u,c,f){if(d.isUndefined(c)){if(!d.isUndefined(u))return r(void 0,u,f)}else return r(u,c,f)}function i(u,c){if(!d.isUndefined(c))return r(void 0,c)}function o(u,c){if(d.isUndefined(c)){if(!d.isUndefined(u))return r(void 0,u)}else return r(void 0,c)}function a(u,c,f){if(f in e)return r(u,c);if(f in t)return r(void 0,u)}const l={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(u,c)=>s(kt(u),kt(c),!0)};return d.forEach(Object.keys(Object.assign({},t,e)),function(c){const f=l[c]||s,_=f(t[c],e[c],c);d.isUndefined(_)&&f!==a||(n[c]=_)}),n}const Pn=t=>{const e=V({},t);let{data:n,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:i,headers:o,auth:a}=e;e.headers=o=R.from(o),e.url=En(Rn(e.baseURL,e.url),t.params,t.paramsSerializer),a&&o.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let l;if(d.isFormData(n)){if(I.hasStandardBrowserEnv||I.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((l=o.getContentType())!==!1){const[u,...c]=l?l.split(";").map(f=>f.trim()).filter(Boolean):[];o.setContentType([u||"multipart/form-data",...c].join("; "))}}if(I.hasStandardBrowserEnv&&(r&&d.isFunction(r)&&(r=r(e)),r||r!==!1&&ps(e.url))){const u=s&&i&&ms.read(i);u&&o.set(s,u)}return e},_s=typeof XMLHttpRequest<"u",bs=_s&&function(t){return new Promise(function(n,r){const s=Pn(t);let i=s.data;const o=R.from(s.headers).normalize();let{responseType:a}=s,l;function u(){s.cancelToken&&s.cancelToken.unsubscribe(l),s.signal&&s.signal.removeEventListener("abort",l)}let c=new XMLHttpRequest;c.open(s.method.toUpperCase(),s.url,!0),c.timeout=s.timeout;function f(){if(!c)return;const m=R.from("getAllResponseHeaders"in c&&c.getAllResponseHeaders()),p={data:!a||a==="text"||a==="json"?c.responseText:c.response,status:c.status,statusText:c.statusText,headers:m,config:t,request:c};An(function(v){n(v),u()},function(v){r(v),u()},p),c=null}"onloadend"in c?c.onloadend=f:c.onreadystatechange=function(){!c||c.readyState!==4||c.status===0&&!(c.responseURL&&c.responseURL.indexOf("file:")===0)||setTimeout(f)},c.onabort=function(){c&&(r(new y("Request aborted",y.ECONNABORTED,s,c)),c=null)},c.onerror=function(){r(new y("Network Error",y.ERR_NETWORK,s,c)),c=null},c.ontimeout=function(){let h=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const p=s.transitional||vn;s.timeoutErrorMessage&&(h=s.timeoutErrorMessage),r(new y(h,p.clarifyTimeoutError?y.ETIMEDOUT:y.ECONNABORTED,s,c)),c=null},i===void 0&&o.setContentType(null),"setRequestHeader"in c&&d.forEach(o.toJSON(),function(h,p){c.setRequestHeader(p,h)}),d.isUndefined(s.withCredentials)||(c.withCredentials=!!s.withCredentials),a&&a!=="json"&&(c.responseType=s.responseType),typeof s.onDownloadProgress=="function"&&c.addEventListener("progress",Te(s.onDownloadProgress,!0)),typeof s.onUploadProgress=="function"&&c.upload&&c.upload.addEventListener("progress",Te(s.onUploadProgress)),(s.cancelToken||s.signal)&&(l=m=>{c&&(r(!m||m.type?new se(null,t,c):m),c.abort(),c=null)},s.cancelToken&&s.cancelToken.subscribe(l),s.signal&&(s.signal.aborted?l():s.signal.addEventListener("abort",l)));const _=ds(s.url);if(_&&I.protocols.indexOf(_)===-1){r(new y("Unsupported protocol "+_+":",y.ERR_BAD_REQUEST,t));return}c.send(i||null)})},Ss=(t,e)=>{let n=new AbortController,r;const s=function(l){if(!r){r=!0,o();const u=l instanceof Error?l:this.reason;n.abort(u instanceof y?u:new se(u instanceof Error?u.message:u))}};let i=e&&setTimeout(()=>{s(new y(`timeout ${e} of ms exceeded`,y.ETIMEDOUT))},e);const o=()=>{t&&(i&&clearTimeout(i),i=null,t.forEach(l=>{l&&(l.removeEventListener?l.removeEventListener("abort",s):l.unsubscribe(s))}),t=null)};t.forEach(l=>l&&l.addEventListener&&l.addEventListener("abort",s));const{signal:a}=n;return a.unsubscribe=o,[a,()=>{i&&clearTimeout(i),i=null}]},ws=function*(t,e){let n=t.byteLength;if(n<e){yield t;return}let r=0,s;for(;r<n;)s=r+e,yield t.slice(r,s),r=s},Es=async function*(t,e,n){for await(const r of t)yield*ws(ArrayBuffer.isView(r)?r:await n(String(r)),e)},Nt=(t,e,n,r,s)=>{const i=Es(t,e,s);let o=0;return new ReadableStream({type:"bytes",async pull(a){const{done:l,value:u}=await i.next();if(l){a.close(),r();return}let c=u.byteLength;n&&n(o+=c),a.enqueue(new Uint8Array(u))},cancel(a){return r(a),i.return()}},{highWaterMark:2})},Dt=(t,e)=>{const n=t!=null;return r=>setTimeout(()=>e({lengthComputable:n,total:t,loaded:r}))},Le=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",On=Le&&typeof ReadableStream=="function",Qe=Le&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),vs=On&&(()=>{let t=!1;const e=new Request(I.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e})(),Lt=64*1024,Ze=On&&!!(()=>{try{return d.isReadableStream(new Response("").body)}catch{}})(),Ce={stream:Ze&&(t=>t.body)};Le&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Ce[e]&&(Ce[e]=d.isFunction(t[e])?n=>n[e]():(n,r)=>{throw new y(`Response type '${e}' is not supported`,y.ERR_NOT_SUPPORT,r)})})})(new Response);const Ts=async t=>{if(t==null)return 0;if(d.isBlob(t))return t.size;if(d.isSpecCompliantForm(t))return(await new Request(t).arrayBuffer()).byteLength;if(d.isArrayBufferView(t))return t.byteLength;if(d.isURLSearchParams(t)&&(t=t+""),d.isString(t))return(await Qe(t)).byteLength},Cs=async(t,e)=>{const n=d.toFiniteNumber(t.getContentLength());return n??Ts(e)},As=Le&&(async t=>{let{url:e,method:n,data:r,signal:s,cancelToken:i,timeout:o,onDownloadProgress:a,onUploadProgress:l,responseType:u,headers:c,withCredentials:f="same-origin",fetchOptions:_}=Pn(t);u=u?(u+"").toLowerCase():"text";let[m,h]=s||i||o?Ss([s,i],o):[],p,E;const v=()=>{!p&&setTimeout(()=>{m&&m.unsubscribe()}),p=!0};let C;try{if(l&&vs&&n!=="get"&&n!=="head"&&(C=await Cs(c,r))!==0){let k=new Request(e,{method:"POST",body:r,duplex:"half"}),B;d.isFormData(r)&&(B=k.headers.get("content-type"))&&c.setContentType(B),k.body&&(r=Nt(k.body,Lt,Dt(C,Te(l)),null,Qe))}d.isString(f)||(f=f?"cors":"omit"),E=new Request(e,{..._,signal:m,method:n.toUpperCase(),headers:c.normalize().toJSON(),body:r,duplex:"half",withCredentials:f});let b=await fetch(E);const U=Ze&&(u==="stream"||u==="response");if(Ze&&(a||U)){const k={};["status","statusText","headers"].forEach(Ct=>{k[Ct]=b[Ct]});const B=d.toFiniteNumber(b.headers.get("content-length"));b=new Response(Nt(b.body,Lt,a&&Dt(B,Te(a,!0)),U&&v,Qe),k)}u=u||"text";let je=await Ce[d.findKey(Ce,u)||"text"](b,t);return!U&&v(),h&&h(),await new Promise((k,B)=>{An(k,B,{data:je,headers:R.from(b.headers),status:b.status,statusText:b.statusText,config:t,request:E})})}catch(b){throw v(),b&&b.name==="TypeError"&&/fetch/i.test(b.message)?Object.assign(new y("Network Error",y.ERR_NETWORK,t,E),{cause:b.cause||b}):y.from(b,b&&b.code,t,E)}}),et={http:Kr,xhr:bs,fetch:As};d.forEach(et,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const Ut=t=>`- ${t}`,Rs=t=>d.isFunction(t)||t===null||t===!1,In={getAdapter:t=>{t=d.isArray(t)?t:[t];const{length:e}=t;let n,r;const s={};for(let i=0;i<e;i++){n=t[i];let o;if(r=n,!Rs(n)&&(r=et[(o=String(n)).toLowerCase()],r===void 0))throw new y(`Unknown adapter '${o}'`);if(r)break;s[o||"#"+i]=r}if(!r){const i=Object.entries(s).map(([a,l])=>`adapter ${a} `+(l===!1?"is not supported by the environment":"is not available in the build"));let o=e?i.length>1?`since :
`+i.map(Ut).join(`
`):" "+Ut(i[0]):"as no adapter specified";throw new y("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return r},adapters:et};function Je(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new se(null,t)}function Ft(t){return Je(t),t.headers=R.from(t.headers),t.data=qe.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),In.getAdapter(t.adapter||de.adapter)(t).then(function(r){return Je(t),r.data=qe.call(t,t.transformResponse,r),r.headers=R.from(r.headers),r},function(r){return Cn(r)||(Je(t),r&&r.response&&(r.response.data=qe.call(t,t.transformResponse,r.response),r.response.headers=R.from(r.response.headers))),Promise.reject(r)})}const xn="1.7.2",gt={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{gt[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}});const Mt={};gt.transitional=function(e,n,r){function s(i,o){return"[Axios v"+xn+"] Transitional option '"+i+"'"+o+(r?". "+r:"")}return(i,o,a)=>{if(e===!1)throw new y(s(o," has been removed"+(n?" in "+n:"")),y.ERR_DEPRECATED);return n&&!Mt[o]&&(Mt[o]=!0,console.warn(s(o," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(i,o,a):!0}};function Ps(t,e,n){if(typeof t!="object")throw new y("options must be an object",y.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let s=r.length;for(;s-- >0;){const i=r[s],o=e[i];if(o){const a=t[i],l=a===void 0||o(a,i,t);if(l!==!0)throw new y("option "+i+" must be "+l,y.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new y("Unknown option "+i,y.ERR_BAD_OPTION)}}const tt={assertOptions:Ps,validators:gt},j=tt.validators;let z=class{constructor(e){this.defaults=e,this.interceptors={request:new It,response:new It}}async request(e,n){try{return await this._request(e,n)}catch(r){if(r instanceof Error){let s;Error.captureStackTrace?Error.captureStackTrace(s={}):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{r.stack?i&&!String(r.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+i):r.stack=i}catch{}}throw r}}_request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=V(this.defaults,n);const{transitional:r,paramsSerializer:s,headers:i}=n;r!==void 0&&tt.assertOptions(r,{silentJSONParsing:j.transitional(j.boolean),forcedJSONParsing:j.transitional(j.boolean),clarifyTimeoutError:j.transitional(j.boolean)},!1),s!=null&&(d.isFunction(s)?n.paramsSerializer={serialize:s}:tt.assertOptions(s,{encode:j.function,serialize:j.function},!0)),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=i&&d.merge(i.common,i[n.method]);i&&d.forEach(["delete","get","head","post","put","patch","common"],h=>{delete i[h]}),n.headers=R.concat(o,i);const a=[];let l=!0;this.interceptors.request.forEach(function(p){typeof p.runWhen=="function"&&p.runWhen(n)===!1||(l=l&&p.synchronous,a.unshift(p.fulfilled,p.rejected))});const u=[];this.interceptors.response.forEach(function(p){u.push(p.fulfilled,p.rejected)});let c,f=0,_;if(!l){const h=[Ft.bind(this),void 0];for(h.unshift.apply(h,a),h.push.apply(h,u),_=h.length,c=Promise.resolve(n);f<_;)c=c.then(h[f++],h[f++]);return c}_=a.length;let m=n;for(f=0;f<_;){const h=a[f++],p=a[f++];try{m=h(m)}catch(E){p.call(this,E);break}}try{c=Ft.call(this,m)}catch(h){return Promise.reject(h)}for(f=0,_=u.length;f<_;)c=c.then(u[f++],u[f++]);return c}getUri(e){e=V(this.defaults,e);const n=Rn(e.baseURL,e.url);return En(n,e.params,e.paramsSerializer)}};d.forEach(["delete","get","head","options"],function(e){z.prototype[e]=function(n,r){return this.request(V(r||{},{method:e,url:n,data:(r||{}).data}))}});d.forEach(["post","put","patch"],function(e){function n(r){return function(i,o,a){return this.request(V(a||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}z.prototype[e]=n(),z.prototype[e+"Form"]=n(!0)});let Os=class kn{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const r=this;this.promise.then(s=>{if(!r._listeners)return;let i=r._listeners.length;for(;i-- >0;)r._listeners[i](s);r._listeners=null}),this.promise.then=s=>{let i;const o=new Promise(a=>{r.subscribe(a),i=a}).then(s);return o.cancel=function(){r.unsubscribe(i)},o},e(function(i,o,a){r.reason||(r.reason=new se(i,o,a),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}static source(){let e;return{token:new kn(function(s){e=s}),cancel:e}}};function Is(t){return function(n){return t.apply(null,n)}}function xs(t){return d.isObject(t)&&t.isAxiosError===!0}const nt={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(nt).forEach(([t,e])=>{nt[e]=t});function Nn(t){const e=new z(t),n=ln(z.prototype.request,e);return d.extend(n,z.prototype,e,{allOwnKeys:!0}),d.extend(n,e,null,{allOwnKeys:!0}),n.create=function(s){return Nn(V(t,s))},n}const T=Nn(de);T.Axios=z;T.CanceledError=se;T.CancelToken=Os;T.isCancel=Cn;T.VERSION=xn;T.toFormData=De;T.AxiosError=y;T.Cancel=T.CanceledError;T.all=function(e){return Promise.all(e)};T.spread=Is;T.isAxiosError=xs;T.mergeConfig=V;T.AxiosHeaders=R;T.formToJSON=t=>Tn(d.isHTMLForm(t)?new FormData(t):t);T.getAdapter=In.getAdapter;T.HttpStatusCode=nt;T.default=T;const{Axios:mc,AxiosError:gc,CanceledError:yc,isCancel:_c,CancelToken:bc,VERSION:Sc,all:wc,Cancel:Ec,isAxiosError:vc,spread:Tc,toFormData:Cc,AxiosHeaders:Ac,HttpStatusCode:Rc,formToJSON:Pc,getAdapter:Oc,mergeConfig:Ic}=T;/*! js-cookie v3.0.5 | MIT */function pe(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}var ks={read:function(t){return t[0]==='"'&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function rt(t,e){function n(s,i,o){if(!(typeof document>"u")){o=pe({},e,o),typeof o.expires=="number"&&(o.expires=new Date(Date.now()+o.expires*864e5)),o.expires&&(o.expires=o.expires.toUTCString()),s=encodeURIComponent(s).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var a="";for(var l in o)o[l]&&(a+="; "+l,o[l]!==!0&&(a+="="+o[l].split(";")[0]));return document.cookie=s+"="+t.write(i,s)+a}}function r(s){if(!(typeof document>"u"||arguments.length&&!s)){for(var i=document.cookie?document.cookie.split("; "):[],o={},a=0;a<i.length;a++){var l=i[a].split("="),u=l.slice(1).join("=");try{var c=decodeURIComponent(l[0]);if(o[c]=t.read(u,c),s===c)break}catch{}}return s?o[s]:o}}return Object.create({set:n,get:r,remove:function(s,i){n(s,"",pe({},i,{expires:-1}))},withAttributes:function(s){return rt(this.converter,pe({},this.attributes,s))},withConverter:function(s){return rt(pe({},this.converter,s),this.attributes)}},{attributes:{value:Object.freeze(e)},converter:{value:Object.freeze(t)}})}var Ns=rt(ks,{path:"/"}),$t={};const S=T.create({headers:{"Content-Type":"application/json"},baseURL:typeof process<"u"?$t.NEXT_PUBLIC_API_URL||$t.PLASMO_PUBLIC_API_URL:"https://earnbetter.com/api/v1"});async function Ds(t){return typeof chrome<"u"&&chrome.cookies?new Promise(e=>{chrome.cookies.get({url:t,name:"csrftoken"},n=>{e(n?.value)})}):Ns.get("csrftoken")}S.interceptors.request.use(async t=>{const e=await Ds(t.baseURL);if(e){const n={...t.headers};n["X-CSRFToken"]=e,t.headers=n}return t.withCredentials=!0,t},t=>Promise.reject(t));const Ls=async(t,e)=>(await S({method:"POST",url:"/auth/sso/google/",data:{credential:t,initial_url_params:e},withCredentials:!0})).data,st=async()=>{const t=await S({method:"GET",url:"/me/",params:{expand:"desired_location"}}),{data:e}=t;return e?.is_coach&&e?.impersonating?.id&&e?.impersonating?.id!==e?.id?{...e,registration_complete:!0,flags:{feedback_cover_letter:!0,feedback_jobs:!0,feedback_resume:!0,jobs_apply_custom_docs:!0,jobs_intro_dialog:!0,jobs_product_tour:!0,job_tracker_intro_dialog:!0}}:e},Us=async t=>(await S({method:"POST",url:"/user_feedback/",data:t})).data,Fs=async t=>(await S({method:"PATCH",url:"/user_feedback/",data:t})).data;var te={};const yt=(t="")=>new URL(t).origin,Ms=typeof process<"u"?te.NEXT_PUBLIC_APPLICATION_URL||te.PLASMO_PUBLIC_APPLICATION_URL:"https://earnbetter.com/app",Bt=typeof process<"u"?te.NEXT_PUBLIC_CHROME_EXTENSION_ID||te.PLASMO_PUBLIC_CHROME_EXTENSION_ID:"dipmddknpfmlbdladkhofaimddikfdmc",$s=typeof process<"u"?te.NEXT_PUBLIC_API_URL||te.PLASMO_PUBLIC_API_URL:"https://earnbetter.com/api/v1",Bs=Bt?`chrome-extension://${Bt}`:void 0,P=yt(Ms);yt($s);const it=yt(Bs);var js={};const me={ping:H("ping","background"),closeExtension:H("close-extension","content"),requestSession:H("request-session","background"),exchangeGoogleCredential:H("exchangeGoogleCredential","background"),similarJobsCount:H("similar-jobs-count","content"),requestCurrentUrl:H("request-current-url","content",!0),requestPageDetails:H("request-page-details","content",!0),requestHTML:H("request-html","content",!0)},Dn={sessionUpdated:jt("session-updated","app"),forceShowExtension:jt("force-show-extension","content")},Hs={requestSession:Ks("request-session","background")};function H(t,e="background",n=!1){return{name:t,send:r=>chrome.runtime.sendMessage(js.NEXT_PUBLIC_CHROME_EXTENSION_ID,{eventName:t,payload:r}),background:{match:(r,s)=>e==="background"&&s.origin===P&&r.eventName===t,matchForContent:(r,s)=>e==="content"&&s.origin===P&&r.eventName===t,sendToContent:(r,s)=>{if(e!=="content")throw new Error("This message is not intended for the content script");return chrome.tabs.sendMessage(r,s)},returnContentResponse:n},content:{match:(r,s)=>e==="content"&&s.origin===it&&r.eventName===t}}}function jt(t,e="content"){return{name:t,destination:e,send:(n,r)=>chrome.tabs.sendMessage(n,{eventName:t,payload:r}),content:{match:(n,r)=>e==="content"&&r.origin===it&&n?.eventName===t,matchForApp:(n,r)=>e==="app"&&r.origin===it&&n?.eventName===t,sendToApp:(n,r)=>{if(e!=="app")throw new Error("This message is not intended for the app");n.contentWindow?.postMessage({eventName:t,payload:r},P)}},app:{match:n=>e==="app"&&n?.data.eventName===t}}}function Ks(t,e){return{name:t,send:(n,r)=>{if(e==="app"){if(!r)throw new Error("An iframe is required to send a message to the app");r.contentWindow?.postMessage({eventName:t,payload:n},P)}return e==="background"?chrome.runtime.sendMessage({eventName:t,payload:n}):Promise.resolve()},app:{match:n=>e==="app"&&n?.data.eventName===t},background:{match:(n,r)=>e==="background"&&n.eventName===t}}}async function qs(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n);return Array.from(new Uint8Array(r)).map(o=>o.toString(16).padStart(2,"0")).join("")}const Ht="hashedSessionId",Ae=async()=>{const[t,e]=await Promise.all([chrome.cookies.get({url:P,name:"sessionid"}),chrome.cookies.get({url:P,name:"isregistered"})]);return{sessionID:t?.value,isRegistered:e?.value}};function Js(){chrome.runtime.onMessageExternal.addListener((t,e,n)=>{if(me.ping.background.match(t,e))return n(!0),!0;if(me.requestSession.background.match(t,e))return Ae().then(n),!0;if(me.exchangeGoogleCredential.background.match(t,e)){const{payload:{credential:s}}=t;return Ls(s).then(i=>n({data:i})).catch(i=>n({error:i})),!0}const r=Object.values(me).find(s=>s.background.matchForContent(t,e));if(r&&e.tab?.id){const s=r.background.sendToContent(e.tab.id,t);if(r.background.returnContentResponse)return s.then(i=>n(i)),!0}})}function Ws(){chrome.runtime.onMessage.addListener((t,e,n)=>{if(Hs.requestSession.background.match(t,e))return Ae().then(({sessionID:r,isRegistered:s})=>n({isAuthenticated:!!r,isRegistered:!!s})),!0})}async function zs(t){let{hashedSessionId:e}=await chrome.storage.local.get(Ht),{sessionID:n,isRegistered:r}=await Ae();const s=n?await st():void 0;t.forEach(o=>{o(s,!0)});const i=async o=>{const a=n!==o.sessionID,l=r!==o.isRegistered;if(a){const u=o.sessionID?qs(o.sessionID):void 0,c=o.sessionID?await st():void 0;e!==u&&(await chrome.storage.local.set({[Ht]:u}),e=u,t.forEach(f=>f(c)))}(a||l)&&(r=o.isRegistered,n=o.sessionID,chrome.tabs.query({},u=>{u.forEach(c=>{c.id&&Dn.sessionUpdated.send(c.id,{isAuthenticated:!!o.sessionID,isRegistered:!!o.isRegistered})})}))};chrome.cookies.onChanged.addListener(async o=>{if((P.endsWith(o.cookie.domain)||P.includes("localhost")&&o.cookie.domain==="localhost")&&(o.cookie.name==="sessionid"||o.cookie.name==="isregistered")){const l=await Ae();i(l)}})}const Vs=async({next:t,previous:e,page_size:n,customization:r="basic",completed:s=!0}={})=>(await S({method:"GET",url:"/coverletter/",params:{next:t,previous:e,page_size:n,customization:r,completed:s}})).data,Gs=async t=>(await S({method:"GET",url:`/coverletter/${t.id}/download/`,responseType:"blob"})).data,w=(t,e,n={isBlob:!1})=>{const{isBlob:r}=n,s=((...i)=>chrome.runtime.sendMessage({eventName:e,args:i}).then(o=>{if(o?.error)throw o.error;if(!r)return o;const a=o.split(","),l=a[0].match(/:(.*?);/)[1],u=atob(a[1]);let c=u.length;const f=new Uint8Array(c);for(;c--;)f[c]=u.charCodeAt(c);return new Blob([f],{type:l})}));return s.id=e,s.clientCall=t,r&&(s.clientCall=async(...i)=>{const o=await t(...i);return new Promise((a,l)=>{const u=new FileReader;u.onloadend=()=>a(u.result),u.onerror=l,u.readAsDataURL(o)})}),s},Xs=w(Vs,"getCoverLetters"),Ys=w(Gs,"downloadCoverLetter",{isBlob:!0}),Qs=async()=>(await S({method:"GET",url:"/extension/config/"})).data,Zs=async()=>(await S({method:"GET",url:"/extension/sites/"})).data,ei=async t=>(await S({method:"GET",url:`/extension/sites/${t}`})).data,ti=async t=>(await S({method:"POST",url:"/extension/sites/",data:t})).data,ni=async(t,e)=>(await S({method:"PUT",url:`/extension/sites/${t}/`,data:e})).data,ri=async(t,e)=>(await S({method:"POST",url:`/extension/sites/${t}/publish/`,data:e??{}})).data,si=async t=>(await S({method:"GET",url:"/extension/site-configs",params:{siteID:t}})).data,ii=async t=>(await S({method:"GET",url:`/extension/site-configs/${t}`})).data,oi=async t=>(await S({method:"POST",url:"/extension/site-configs/",data:t})).data,ai=async(t,e)=>(await S({method:"PUT",url:`/extension/site-configs/${t}/`,data:e})).data,ci=async t=>(await S({method:"DELETE",url:`/extension/site-configs/${t}/`})).data,ui=w(Qs,"getConfig"),li=w(Zs,"getSites"),di=w(ei,"getSite"),fi=w(ti,"createSite"),hi=w(ni,"updateSite"),pi=w(ri,"publishSiteConfig"),mi=w(si,"getSiteConfigs"),gi=w(ii,"getSiteConfig"),yi=w(oi,"createSiteConfig"),_i=w(ai,"updateSiteConfig"),bi=w(ci,"deleteSiteConfig"),Si=async t=>(await S({method:"POST",url:"/external-job/",data:t})).data,wi=w(Si,"createExternalJob"),Ei=w(st,"getMe"),vi=w(Us,"submitFeedback"),Ti=w(Fs,"updateFeedback");var Kt={};const Ci=async({next:t,previous:e,page_size:n,customization:r="basic",completed:s=!0}={})=>(await S({method:"GET",url:"/resume/",params:{next:t,previous:e,page_size:n,customization:r,completed:s}})).data,Ai=typeof process<"u"?Kt.NEXT_PUBLIC_APPLICATION_URL||Kt.PLASMO_PUBLIC_APPLICATION_URL:"https://earnbetter.com/app",Ri=async t=>(await S({method:"POST",url:`${Ai}/api/pdf/resume/`,data:{resumeData:JSON.stringify(t.resume_data),resumeTemplate:JSON.stringify(t.template)},responseType:"blob"})).data,Pi=w(Ci,"getResumes"),Oi=w(Ri,"downloadResume",{isBlob:!0}),Ii=async({expand:t,docs_only:e}={})=>(await S({method:"GET",url:"/job-trackers/all/",params:{expand:t?.join(","),docs_only:e}})).data,xi=async({jobRef:t,expand:e})=>(await S({method:"GET",url:`/job-trackers/${t.id}/`,params:{expand:e?.join(",")}})).data,ki=async({jobRef:t,data:e,status:n,expand:r})=>(await S({method:"PATCH",url:`/job-trackers/${t.id}/`,params:{expand:r?.join(",")},data:{...Ni(n),...e}})).data,Ni=t=>{switch(t){case"unsave":return{saved:!1,applied:!1,interviewing:!1,date_of_interview:null,got_job:!1,archived:!1,auto_archived:!1,blocked:!1};case"saved":return{saved:!0,applied:!1,interviewing:!1,date_of_interview:null,got_job:!1,archived:!1,auto_archived:!1,blocked:!1};case"applied":return{saved:!0,applied:!0,interviewing:!1,date_of_interview:null,got_job:!1,archived:!1,auto_archived:!1,blocked:!1};case"interviewing":return{saved:!0,applied:!0,interviewing:!0,date_of_interview:null,got_job:!1,archived:!1,auto_archived:!1,blocked:!1};case"got_job":return{got_job:!0};case"archived":return{archived:!0,auto_archived:!1};case"unarchive":return{archived:!1,auto_archived:!1};case"block":return{blocked:!0};case"unblock":return{blocked:!1};default:return{}}},Di=async t=>(await S({method:"POST",url:"/job-trackers/match/",params:{expand:"job"},data:t})).data,Li=w(Ii,"getTrackedJobs"),Ui=w(xi,"getTrackedJob"),Fi=w(Di,"matchTrackedJob"),Mi=w(ki,"patchTrackedJob"),$i=Object.freeze(Object.defineProperty({__proto__:null,createExternalJob:wi,createSite:fi,createSiteConfig:yi,deleteSiteConfig:bi,downloadCoverLetter:Ys,downloadResume:Oi,getConfig:ui,getCoverLetters:Xs,getMe:Ei,getResumes:Pi,getSite:di,getSiteConfig:gi,getSiteConfigs:mi,getSites:li,getTrackedJob:Ui,getTrackedJobs:Li,matchTrackedJob:Fi,patchTrackedJob:Mi,publishSiteConfig:pi,submitFeedback:vi,updateFeedback:Ti,updateSite:hi,updateSiteConfig:_i},Symbol.toStringTag,{value:"Module"})),Bi=()=>{const t=Object.values($i).filter(n=>typeof n=="function"&&n?.id&&n?.clientCall).map(n=>[n.id,n.clientCall]),e=Object.fromEntries(t);chrome.runtime.onMessage.addListener((n,r,s)=>{const i=e[n.eventName];if(i)return Promise.resolve(i(...n?.args??[])).then(o=>s(o)).catch(o=>s({error:o})),!0})};function ji(){let t=Date.now();chrome.runtime.onMessage.addListener((n,r,s)=>{n.type==="GET_CURRENT_TAB"&&(r.tab?.id?(s({tabID:r.tab.id}),e()):s({error:"Tab ID not found"}))});const e=async()=>{if(Date.now()-t<5e3)return;t=Date.now();const n=await chrome.storage.local.get(null),r=Date.now();for(const[s,i]of Object.entries(n))i.ttl&&r>i.ttl&&await chrome.storage.local.remove(s)}}var ot=function(t,e){return ot=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},ot(t,e)};function Ue(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");ot(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var g=function(){return g=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},g.apply(this,arguments)};function Hi(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function N(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(c){try{u(r.next(c))}catch(f){o(f)}}function l(c){try{u(r.throw(c))}catch(f){o(f)}}function u(c){c.done?i(c.value):s(c.value).then(a,l)}u((r=r.apply(t,e||[])).next())})}function D(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=a(0),o.throw=a(1),o.return=a(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(c){return l([u,c])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(n=0)),n;)try{if(r=1,s&&(i=u[0]&2?s.return:u[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,u[1])).done)return i;switch(s=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,s=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){n.label=u[1];break}if(u[0]===6&&n.label<i[1]){n.label=i[1],i=u;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(u);break}i[2]&&n.ops.pop(),n.trys.pop();continue}u=e.call(t,n)}catch(c){u=[6,c],s=0}finally{r=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function qt(t,e,n){if(n||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}function at(t,e,n){e.split&&(e=e.split("."));for(var r=0,s=e.length,i=t,o,a;r<s&&(a=""+e[r++],!(a==="__proto__"||a==="constructor"||a==="prototype"));)i=i[a]=r===s?n:typeof(o=i[a])==typeof e?o:e[r]*0!==0||~(""+e[r]).indexOf(".")?{}:[]}var Ki=function(t,e){return Object.keys(t).filter(function(n){return e(n,t[n])}).reduce(function(n,r){return n[r]=t[r],n},{})},L=(function(t){Ue(e,t);function e(n,r){var s=t.call(this,"".concat(n," ").concat(r))||this;return s.field=n,s}return e})(Error);function Fe(t){return typeof t=="string"}function Ln(t){return t!=null}function Un(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()==="object"}var Me="is not a string",_t="is not an object",Fn="is nil";function qi(t){var e=".userId/anonymousId/previousId/groupId",n=function(s){var i,o,a;return(a=(o=(i=s.userId)!==null&&i!==void 0?i:s.anonymousId)!==null&&o!==void 0?o:s.groupId)!==null&&a!==void 0?a:s.previousId},r=n(t);if(Ln(r)){if(!Fe(r))throw new L(e,Me)}else throw new L(e,Fn)}function Ji(t){if(!Ln(t))throw new L("Event",Fn);if(typeof t!="object")throw new L("Event",_t)}function Wi(t){if(!Fe(t.type))throw new L(".type",Me)}function zi(t){if(!Fe(t.event))throw new L(".event",Me)}function Vi(t){if(!Un(t.properties))throw new L(".properties",_t)}function Gi(t){if(!Un(t.traits))throw new L(".traits",_t)}function Xi(t){if(!Fe(t.messageId))throw new L(".messageId",Me)}function Yi(t){Ji(t),Wi(t),Xi(t),t.type==="track"&&(zi(t),Vi(t)),["group","identify"].includes(t.type)&&Gi(t)}var Qi=(function(){function t(e){var n,r;this.settings=e,this.createMessageId=e.createMessageId,this.onEventMethodCall=(n=e.onEventMethodCall)!==null&&n!==void 0?n:(function(){}),this.onFinishedEvent=(r=e.onFinishedEvent)!==null&&r!==void 0?r:(function(){})}return t})(),Zi=(function(){function t(e){this.settings=new Qi(e)}return t.prototype.track=function(e,n,r,s){return this.settings.onEventMethodCall({type:"track",options:r}),this.normalize(g(g({},this.baseEvent()),{event:e,type:"track",properties:n??{},options:g({},r),integrations:g({},s)}))},t.prototype.page=function(e,n,r,s,i){var o;this.settings.onEventMethodCall({type:"page",options:s});var a={type:"page",properties:g({},r),options:g({},s),integrations:g({},i)};return e!==null&&(a.category=e,a.properties=(o=a.properties)!==null&&o!==void 0?o:{},a.properties.category=e),n!==null&&(a.name=n),this.normalize(g(g({},this.baseEvent()),a))},t.prototype.screen=function(e,n,r,s,i){this.settings.onEventMethodCall({type:"screen",options:s});var o={type:"screen",properties:g({},r),options:g({},s),integrations:g({},i)};return e!==null&&(o.category=e),n!==null&&(o.name=n),this.normalize(g(g({},this.baseEvent()),o))},t.prototype.identify=function(e,n,r,s){return this.settings.onEventMethodCall({type:"identify",options:r}),this.normalize(g(g({},this.baseEvent()),{type:"identify",userId:e,traits:n??{},options:g({},r),integrations:s}))},t.prototype.group=function(e,n,r,s){return this.settings.onEventMethodCall({type:"group",options:r}),this.normalize(g(g({},this.baseEvent()),{type:"group",traits:n??{},options:g({},r),integrations:g({},s),groupId:e}))},t.prototype.alias=function(e,n,r,s){this.settings.onEventMethodCall({type:"alias",options:r});var i={userId:e,type:"alias",options:g({},r),integrations:g({},s)};return n!==null&&(i.previousId=n),e===void 0?this.normalize(g(g({},i),this.baseEvent())):this.normalize(g(g({},this.baseEvent()),i))},t.prototype.baseEvent=function(){return{integrations:{},options:{}}},t.prototype.context=function(e){var n,r=["userId","anonymousId","timestamp","messageId"];delete e.integrations;var s=Object.keys(e),i=(n=e.context)!==null&&n!==void 0?n:{},o={};return s.forEach(function(a){a!=="context"&&(r.includes(a)?at(o,a,e[a]):at(i,a,e[a]))}),[i,o]},t.prototype.normalize=function(e){var n,r,s=Object.keys((n=e.integrations)!==null&&n!==void 0?n:{}).reduce(function(_,m){var h,p;return g(g({},_),(h={},h[m]=!!(!((p=e.integrations)===null||p===void 0)&&p[m]),h))},{});e.options=Ki(e.options||{},function(_,m){return m!==void 0});var i=g(g({},s),(r=e.options)===null||r===void 0?void 0:r.integrations),o=e.options?this.context(e.options):[],a=o[0],l=o[1],u=e.options,c=Hi(e,["options"]),f=g(g(g(g({timestamp:new Date},c),{context:a,integrations:i}),l),{messageId:u.messageId||this.settings.createMessageId()});return this.settings.onFinishedEvent(f),Yi(f),f},t})();function Mn(t,e){return new Promise(function(n,r){var s=setTimeout(function(){r(Error("Promise timed out"))},e);t.then(function(i){return clearTimeout(s),n(i)}).catch(r)})}function $n(t){return new Promise(function(e){return setTimeout(e,t)})}function eo(t,e,n){var r=function(){try{return Promise.resolve(e(t))}catch(s){return Promise.reject(s)}};return $n(n).then(function(){return Mn(r(),1e3)}).catch(function(s){t?.log("warn","Callback Error",{error:s}),t?.stats.increment("callback_error")}).then(function(){return t})}var to=function(){var t,e,n=!1,r=new Promise(function(s,i){t=function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];n=!0,s.apply(void 0,o)},e=function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];n=!0,i.apply(void 0,o)}});return{resolve:t,reject:e,promise:r,isSettled:function(){return n}}},fe=(function(){function t(e){var n;this.callbacks={},this.warned=!1,this.maxListeners=(n=e?.maxListeners)!==null&&n!==void 0?n:10}return t.prototype.warnIfPossibleMemoryLeak=function(e){this.warned||this.maxListeners&&this.callbacks[e].length>this.maxListeners&&(console.warn("Event Emitter: Possible memory leak detected; ".concat(String(e)," has exceeded ").concat(this.maxListeners," listeners.")),this.warned=!0)},t.prototype.on=function(e,n){return this.callbacks[e]?(this.callbacks[e].push(n),this.warnIfPossibleMemoryLeak(e)):this.callbacks[e]=[n],this},t.prototype.once=function(e,n){var r=this,s=function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];r.off(e,s),n.apply(r,i)};return this.on(e,s),this},t.prototype.off=function(e,n){var r,s=(r=this.callbacks[e])!==null&&r!==void 0?r:[],i=s.filter(function(o){return o!==n});return this.callbacks[e]=i,this},t.prototype.emit=function(e){for(var n=this,r,s=[],i=1;i<arguments.length;i++)s[i-1]=arguments[i];var o=(r=this.callbacks[e])!==null&&r!==void 0?r:[];return o.forEach(function(a){a.apply(n,s)}),this},t})();function bt(t){var e=Math.random()+1,n=t.minTimeout,r=n===void 0?500:n,s=t.factor,i=s===void 0?2:s,o=t.attempt,a=t.maxTimeout,l=a===void 0?1/0:a;return Math.min(e*r*Math.pow(i,o),l)}var Bn="onRemoveFromFuture",no=(function(t){Ue(e,t);function e(n,r,s){var i=t.call(this)||this;return i.future=[],i.maxAttempts=n,i.queue=r,i.seen=s??{},i}return e.prototype.push=function(){for(var n=this,r=[],s=0;s<arguments.length;s++)r[s]=arguments[s];var i=r.map(function(o){var a=n.updateAttempts(o);return a>n.maxAttempts||n.includes(o)?!1:(n.queue.push(o),!0)});return this.queue=this.queue.sort(function(o,a){return n.getAttempts(o)-n.getAttempts(a)}),i},e.prototype.pushWithBackoff=function(n,r){var s=this;if(r===void 0&&(r=0),r==0&&this.getAttempts(n)===0)return this.push(n)[0];var i=this.updateAttempts(n);if(i>this.maxAttempts||this.includes(n))return!1;var o=bt({attempt:i-1});return r>0&&o<r&&(o=r),setTimeout(function(){s.queue.push(n),s.future=s.future.filter(function(a){return a.id!==n.id}),s.emit(Bn)},o),this.future.push(n),!0},e.prototype.getAttempts=function(n){var r;return(r=this.seen[n.id])!==null&&r!==void 0?r:0},e.prototype.updateAttempts=function(n){return this.seen[n.id]=this.getAttempts(n)+1,this.getAttempts(n)},e.prototype.includes=function(n){return this.queue.includes(n)||this.future.includes(n)||!!this.queue.find(function(r){return r.id===n.id})||!!this.future.find(function(r){return r.id===n.id})},e.prototype.pop=function(){return this.queue.shift()},Object.defineProperty(e.prototype,"length",{get:function(){return this.queue.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"todo",{get:function(){return this.queue.length+this.future.length},enumerable:!1,configurable:!0}),e})(fe),W=256,we=[],ge;for(;W--;)we[W]=(W+256).toString(16).substring(1);function $e(){var t=0,e,n="";if(!ge||W+16>256){for(ge=Array(t=256);t--;)ge[t]=256*Math.random()|0;t=W=0}for(;t<16;t++)e=ge[W+t],t==6?n+=we[e&15|64]:t==8?n+=we[e&63|128]:n+=we[e],t&1&&t>1&&t<11&&(n+="-");return W++,n}var ro=(function(){function t(){this._logs=[]}return t.prototype.log=function(e,n,r){var s=new Date;this._logs.push({level:e,message:n,time:s,extras:r})},Object.defineProperty(t.prototype,"logs",{get:function(){return this._logs},enumerable:!1,configurable:!0}),t.prototype.flush=function(){if(this.logs.length>1){var e=this._logs.reduce(function(n,r){var s,i,o,a=g(g({},r),{json:JSON.stringify(r.extras,null," "),extras:r.extras});delete a.time;var l=(o=(i=r.time)===null||i===void 0?void 0:i.toISOString())!==null&&o!==void 0?o:"";return n[l]&&(l="".concat(l,"-").concat(Math.random())),g(g({},n),(s={},s[l]=a,s))},{});console.table?console.table(e):console.log(e)}else this.logs.forEach(function(n){var r=n.level,s=n.message,i=n.extras;r==="info"||r==="debug"?console.log(s,i??""):console[r](s,i??"")});this._logs=[]},t})(),so=function(t){var e={gauge:"g",counter:"c"};return e[t]},io=(function(){function t(){this.metrics=[]}return t.prototype.increment=function(e,n,r){n===void 0&&(n=1),this.metrics.push({metric:e,value:n,tags:r??[],type:"counter",timestamp:Date.now()})},t.prototype.gauge=function(e,n,r){this.metrics.push({metric:e,value:n,tags:r??[],type:"gauge",timestamp:Date.now()})},t.prototype.flush=function(){var e=this.metrics.map(function(n){return g(g({},n),{tags:n.tags.join(",")})});console.table?console.table(e):console.log(e),this.metrics=[]},t.prototype.serialize=function(){return this.metrics.map(function(e){return{m:e.metric,v:e.value,t:e.tags,k:so(e.type),e:e.timestamp}})},t})(),oo=(function(t){Ue(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.gauge=function(){},e.prototype.increment=function(){},e.prototype.flush=function(){},e.prototype.serialize=function(){return[]},e})(io),Re=(function(){function t(e){var n,r,s;this.retry=(n=e.retry)!==null&&n!==void 0?n:!0,this.type=(r=e.type)!==null&&r!==void 0?r:"plugin Error",this.reason=(s=e.reason)!==null&&s!==void 0?s:""}return t})(),Pe=(function(){function t(e,n,r,s){n===void 0&&(n=$e()),r===void 0&&(r=new oo),s===void 0&&(s=new ro),this.attempts=0,this.event=e,this._id=n,this.logger=s,this.stats=r}return t.system=function(){},t.prototype.isSame=function(e){return e.id===this.id},t.prototype.cancel=function(e){throw e||new Re({reason:"Context Cancel"})},t.prototype.log=function(e,n,r){this.logger.log(e,n,r)},Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),t.prototype.updateEvent=function(e,n){var r;if(e.split(".")[0]==="integrations"){var s=e.split(".")[1];if(((r=this.event.integrations)===null||r===void 0?void 0:r[s])===!1)return this.event}return at(this.event,e,n),this.event},t.prototype.failedDelivery=function(){return this._failedDelivery},t.prototype.setFailedDelivery=function(e){this._failedDelivery=e},t.prototype.logs=function(){return this.logger.logs},t.prototype.flush=function(){this.logger.flush(),this.stats.flush()},t.prototype.toJSON=function(){return{id:this._id,event:this.event,logs:this.logger.logs,metrics:this.stats.metrics}},t})();function ao(t,e){var n={};return t.forEach(function(r){var s,i=void 0;{var o=r[e];i=typeof o!="string"?JSON.stringify(o):o}i!==void 0&&(n[i]=qt(qt([],(s=n[i])!==null&&s!==void 0?s:[],!0),[r],!1))}),n}var co=function(t){return typeof t=="object"&&t!==null&&"then"in t&&typeof t.then=="function"},uo=function(){var t,e,n=0;return{done:function(){return t},run:function(r){var s=r();return co(s)&&(++n===1&&(t=new Promise(function(i){return e=i})),s.finally(function(){return--n===0&&e()})),s}}};function lo(t){return N(this,void 0,void 0,function(){var e;return D(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,t()];case 1:return[2,n.sent()];case 2:return e=n.sent(),[2,Promise.reject(e)];case 3:return[2]}})})}function Ee(t,e){t.log("debug","plugin",{plugin:e.name});var n=new Date().getTime(),r=e[t.event.type];if(r===void 0)return Promise.resolve(t);var s=lo(function(){return r.apply(e,[t])}).then(function(i){var o=new Date().getTime()-n;return i.stats.gauge("plugin_time",o,["plugin:".concat(e.name)]),i}).catch(function(i){if(i instanceof Re&&i.type==="middleware_cancellation")throw i;return i instanceof Re?(t.log("warn",i.type,{plugin:e.name,error:i}),i):(t.log("error","plugin Error",{plugin:e.name,error:i}),t.stats.increment("plugin_error",1,["plugin:".concat(e.name)]),i)});return s}function fo(t,e){return Ee(t,e).then(function(n){if(n instanceof Pe)return n;t.log("debug","Context canceled"),t.stats.increment("context_canceled"),t.cancel(n)})}var ho=(function(t){Ue(e,t);function e(n){var r=t.call(this)||this;return r.criticalTasks=uo(),r.plugins=[],r.failedInitializations=[],r.flushing=!1,r.queue=n,r.queue.on(Bn,function(){r.scheduleFlush(0)}),r}return e.prototype.register=function(n,r,s){return N(this,void 0,void 0,function(){var i,o,a=this;return D(this,function(l){switch(l.label){case 0:return this.plugins.push(r),i=function(u){a.failedInitializations.push(r.name),a.emit("initialization_failure",r),console.warn(r.name,u),n.log("warn","Failed to load destination",{plugin:r.name,error:u}),a.plugins=a.plugins.filter(function(c){return c!==r})},r.type==="destination"&&r.name!=="Segment.io"?(r.load(n,s).catch(i),[3,4]):[3,1];case 1:return l.trys.push([1,3,,4]),[4,r.load(n,s)];case 2:return l.sent(),[3,4];case 3:return o=l.sent(),i(o),[3,4];case 4:return[2]}})})},e.prototype.deregister=function(n,r,s){return N(this,void 0,void 0,function(){var i;return D(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),r.unload?[4,Promise.resolve(r.unload(n,s))]:[3,2];case 1:o.sent(),o.label=2;case 2:return this.plugins=this.plugins.filter(function(a){return a.name!==r.name}),[3,4];case 3:return i=o.sent(),n.log("warn","Failed to unload destination",{plugin:r.name,error:i}),[3,4];case 4:return[2]}})})},e.prototype.dispatch=function(n){return N(this,void 0,void 0,function(){var r;return D(this,function(s){return n.log("debug","Dispatching"),n.stats.increment("message_dispatched"),this.queue.push(n),r=this.subscribeToDelivery(n),this.scheduleFlush(0),[2,r]})})},e.prototype.subscribeToDelivery=function(n){return N(this,void 0,void 0,function(){var r=this;return D(this,function(s){return[2,new Promise(function(i){var o=function(a,l){a.isSame(n)&&(r.off("flush",o),i(a))};r.on("flush",o)})]})})},e.prototype.dispatchSingle=function(n){return N(this,void 0,void 0,function(){var r=this;return D(this,function(s){return n.log("debug","Dispatching"),n.stats.increment("message_dispatched"),this.queue.updateAttempts(n),n.attempts=1,[2,this.deliver(n).catch(function(i){var o=r.enqueuRetry(i,n);return o?r.subscribeToDelivery(n):(n.setFailedDelivery({reason:i}),n)})]})})},e.prototype.isEmpty=function(){return this.queue.length===0},e.prototype.scheduleFlush=function(n){var r=this;n===void 0&&(n=500),!this.flushing&&(this.flushing=!0,setTimeout(function(){r.flush().then(function(){setTimeout(function(){r.flushing=!1,r.queue.length&&r.scheduleFlush(0)},0)})},n))},e.prototype.deliver=function(n){return N(this,void 0,void 0,function(){var r,s,i,o;return D(this,function(a){switch(a.label){case 0:return[4,this.criticalTasks.done()];case 1:a.sent(),r=Date.now(),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,this.flushOne(n)];case 3:return n=a.sent(),s=Date.now()-r,this.emit("delivery_success",n),n.stats.gauge("delivered",s),n.log("debug","Delivered",n.event),[2,n];case 4:throw i=a.sent(),o=i,n.log("error","Failed to deliver",o),this.emit("delivery_failure",n,o),n.stats.increment("delivery_failed"),i;case 5:return[2]}})})},e.prototype.enqueuRetry=function(n,r){var s=!(n instanceof Re)||n.retry;return s?this.queue.pushWithBackoff(r):!1},e.prototype.flush=function(){return N(this,void 0,void 0,function(){var n,r,s;return D(this,function(i){switch(i.label){case 0:if(this.queue.length===0)return[2,[]];if(n=this.queue.pop(),!n)return[2,[]];n.attempts=this.queue.getAttempts(n),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.deliver(n)];case 2:return n=i.sent(),this.emit("flush",n,!0),[3,4];case 3:return r=i.sent(),s=this.enqueuRetry(r,n),s||(n.setFailedDelivery({reason:r}),this.emit("flush",n,!1)),[2,[]];case 4:return[2,[n]]}})})},e.prototype.isReady=function(){return!0},e.prototype.availableExtensions=function(n){var r=this.plugins.filter(function(m){var h,p,E;if(m.type!=="destination"&&m.name!=="Segment.io")return!0;var v=void 0;return(h=m.alternativeNames)===null||h===void 0||h.forEach(function(C){n[C]!==void 0&&(v=n[C])}),(E=(p=n[m.name])!==null&&p!==void 0?p:v)!==null&&E!==void 0?E:(m.name==="Segment.io"?!0:n.All)!==!1}),s=ao(r,"type"),i=s.before,o=i===void 0?[]:i,a=s.enrichment,l=a===void 0?[]:a,u=s.destination,c=u===void 0?[]:u,f=s.after,_=f===void 0?[]:f;return{before:o,enrichment:l,destinations:c,after:_}},e.prototype.flushOne=function(n){var r,s;return N(this,void 0,void 0,function(){var i,o,a,l,u,c,h,f,_,m,h,p,E,v,C;return D(this,function(b){switch(b.label){case 0:if(!this.isReady())throw new Error("Not ready");n.attempts>1&&this.emit("delivery_retry",n),i=this.availableExtensions((r=n.event.integrations)!==null&&r!==void 0?r:{}),o=i.before,a=i.enrichment,l=0,u=o,b.label=1;case 1:return l<u.length?(c=u[l],[4,fo(n,c)]):[3,4];case 2:h=b.sent(),h instanceof Pe&&(n=h),this.emit("message_enriched",n,c),b.label=3;case 3:return l++,[3,1];case 4:f=0,_=a,b.label=5;case 5:return f<_.length?(m=_[f],[4,Ee(n,m)]):[3,8];case 6:h=b.sent(),h instanceof Pe&&(n=h),this.emit("message_enriched",n,m),b.label=7;case 7:return f++,[3,5];case 8:return p=this.availableExtensions((s=n.event.integrations)!==null&&s!==void 0?s:{}),E=p.destinations,v=p.after,[4,new Promise(function(U,je){setTimeout(function(){var k=E.map(function(B){return Ee(n,B)});Promise.all(k).then(U).catch(je)},0)})];case 9:return b.sent(),n.stats.increment("message_delivered"),this.emit("message_delivered",n),C=v.map(function(U){return Ee(n,U)}),[4,Promise.all(C)];case 10:return b.sent(),[2,n]}})})},e})(fe),po=function(t,e){var n=Date.now()-t;return Math.max((e??300)-n,0)};function mo(t,e,n,r){return N(this,void 0,void 0,function(){var s,i;return D(this,function(o){switch(o.label){case 0:return n.emit("dispatch_start",t),s=Date.now(),e.isEmpty()?[4,e.dispatchSingle(t)]:[3,2];case 1:return i=o.sent(),[3,4];case 2:return[4,e.dispatch(t)];case 3:i=o.sent(),o.label=4;case 4:return r?.callback?[4,eo(i,r.callback,po(s,r.timeout))]:[3,6];case 5:i=o.sent(),o.label=6;case 6:return r?.debug&&i.flush(),[2,i]}})})}function go(t){for(var e=t.constructor.prototype,n=0,r=Object.getOwnPropertyNames(e);n<r.length;n++){var s=r[n];if(s!=="constructor"){var i=Object.getOwnPropertyDescriptor(t.constructor.prototype,s);i&&typeof i.value=="function"&&(t[s]=t[s].bind(t))}}return t}const yo=t=>{if(!t.writeKey)throw new L("writeKey","writeKey is missing.")},jn="2.2.0",_o=t=>t.replace(/\/$/,""),bo=(t,e)=>_o(new URL(e||"",t).href),Jt=32,Wt=480;class So{id=$e();items=[];sizeInBytes=0;maxEventCount;constructor(e){this.maxEventCount=Math.max(1,e)}tryAdd(e){if(this.length===this.maxEventCount)return{success:!1,message:`Event limit of ${this.maxEventCount} has been exceeded.`};const n=this.calculateSize(e.context);return n>Jt*1024?{success:!1,message:`Event exceeds maximum event size of ${Jt} KB`}:this.sizeInBytes+n>Wt*1024?{success:!1,message:`Event has caused batch size to exceed ${Wt} KB`}:(this.items.push(e),this.sizeInBytes+=n,{success:!0})}get length(){return this.items.length}calculateSize(e){return encodeURI(JSON.stringify(e.event)).split(/%..|i/).length}getEvents(){return this.items.map(({context:n})=>n.event)}getContexts(){return this.items.map(e=>e.context)}resolveEvents(){this.items.forEach(({resolver:e,context:n})=>e(n))}}const Be=crypto,Hn=t=>t instanceof CryptoKey,Z=new TextEncoder,ct=new TextDecoder;function wo(...t){const e=t.reduce((s,{length:i})=>s+i,0),n=new Uint8Array(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return n}const Eo=t=>{let e=t;typeof e=="string"&&(e=Z.encode(e));const n=32768,r=[];for(let s=0;s<e.length;s+=n)r.push(String.fromCharCode.apply(null,e.subarray(s,s+n)));return btoa(r.join(""))},We=t=>Eo(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),vo=t=>{const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n},St=t=>{let e=t;e instanceof Uint8Array&&(e=ct.decode(e)),e=e.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{return vo(e)}catch{throw new TypeError("The input to be decoded is not correctly encoded.")}};class A extends Error{constructor(e,n){super(e,n),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}}A.code="ERR_JOSE_GENERIC";class To extends A{constructor(e,n,r="unspecified",s="unspecified"){super(e,{cause:{claim:r,reason:s,payload:n}}),this.code="ERR_JWT_CLAIM_VALIDATION_FAILED",this.claim=r,this.reason=s,this.payload=n}}To.code="ERR_JWT_CLAIM_VALIDATION_FAILED";class Co extends A{constructor(e,n,r="unspecified",s="unspecified"){super(e,{cause:{claim:r,reason:s,payload:n}}),this.code="ERR_JWT_EXPIRED",this.claim=r,this.reason=s,this.payload=n}}Co.code="ERR_JWT_EXPIRED";class Ao extends A{constructor(){super(...arguments),this.code="ERR_JOSE_ALG_NOT_ALLOWED"}}Ao.code="ERR_JOSE_ALG_NOT_ALLOWED";class M extends A{constructor(){super(...arguments),this.code="ERR_JOSE_NOT_SUPPORTED"}}M.code="ERR_JOSE_NOT_SUPPORTED";class Ro extends A{constructor(e="decryption operation failed",n){super(e,n),this.code="ERR_JWE_DECRYPTION_FAILED"}}Ro.code="ERR_JWE_DECRYPTION_FAILED";class Po extends A{constructor(){super(...arguments),this.code="ERR_JWE_INVALID"}}Po.code="ERR_JWE_INVALID";class Y extends A{constructor(){super(...arguments),this.code="ERR_JWS_INVALID"}}Y.code="ERR_JWS_INVALID";class Kn extends A{constructor(){super(...arguments),this.code="ERR_JWT_INVALID"}}Kn.code="ERR_JWT_INVALID";class Oo extends A{constructor(){super(...arguments),this.code="ERR_JWK_INVALID"}}Oo.code="ERR_JWK_INVALID";class Io extends A{constructor(){super(...arguments),this.code="ERR_JWKS_INVALID"}}Io.code="ERR_JWKS_INVALID";class xo extends A{constructor(e="no applicable key found in the JSON Web Key Set",n){super(e,n),this.code="ERR_JWKS_NO_MATCHING_KEY"}}xo.code="ERR_JWKS_NO_MATCHING_KEY";class ko extends A{constructor(e="multiple matching keys found in the JSON Web Key Set",n){super(e,n),this.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS"}}ko.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";class No extends A{constructor(e="request timed out",n){super(e,n),this.code="ERR_JWKS_TIMEOUT"}}No.code="ERR_JWKS_TIMEOUT";class Do extends A{constructor(e="signature verification failed",n){super(e,n),this.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED"}}Do.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED";function F(t,e="algorithm.name"){return new TypeError(`CryptoKey does not support this operation, its ${e} must be ${t}`)}function ye(t,e){return t.name===e}function ze(t){return parseInt(t.name.slice(4),10)}function Lo(t){switch(t){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw new Error("unreachable")}}function Uo(t,e){if(e.length&&!e.some(n=>t.usages.includes(n))){let n="CryptoKey does not support this operation, its usages must include ";if(e.length>2){const r=e.pop();n+=`one of ${e.join(", ")}, or ${r}.`}else e.length===2?n+=`one of ${e[0]} or ${e[1]}.`:n+=`${e[0]}.`;throw new TypeError(n)}}function Fo(t,e,...n){switch(e){case"HS256":case"HS384":case"HS512":{if(!ye(t.algorithm,"HMAC"))throw F("HMAC");const r=parseInt(e.slice(2),10);if(ze(t.algorithm.hash)!==r)throw F(`SHA-${r}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!ye(t.algorithm,"RSASSA-PKCS1-v1_5"))throw F("RSASSA-PKCS1-v1_5");const r=parseInt(e.slice(2),10);if(ze(t.algorithm.hash)!==r)throw F(`SHA-${r}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!ye(t.algorithm,"RSA-PSS"))throw F("RSA-PSS");const r=parseInt(e.slice(2),10);if(ze(t.algorithm.hash)!==r)throw F(`SHA-${r}`,"algorithm.hash");break}case"EdDSA":{if(t.algorithm.name!=="Ed25519"&&t.algorithm.name!=="Ed448")throw F("Ed25519 or Ed448");break}case"ES256":case"ES384":case"ES512":{if(!ye(t.algorithm,"ECDSA"))throw F("ECDSA");const r=Lo(e);if(t.algorithm.namedCurve!==r)throw F(r,"algorithm.namedCurve");break}default:throw new TypeError("CryptoKey does not support this operation")}Uo(t,n)}function qn(t,e,...n){if(n=n.filter(Boolean),n.length>2){const r=n.pop();t+=`one of type ${n.join(", ")}, or ${r}.`}else n.length===2?t+=`one of type ${n[0]} or ${n[1]}.`:t+=`of type ${n[0]}.`;return e==null?t+=` Received ${e}`:typeof e=="function"&&e.name?t+=` Received function ${e.name}`:typeof e=="object"&&e!=null&&e.constructor?.name&&(t+=` Received an instance of ${e.constructor.name}`),t}const zt=(t,...e)=>qn("Key must be ",t,...e);function Jn(t,e,...n){return qn(`Key for the ${t} algorithm must be `,e,...n)}const Wn=t=>Hn(t)?!0:t?.[Symbol.toStringTag]==="KeyObject",Oe=["CryptoKey"],Mo=(...t)=>{const e=t.filter(Boolean);if(e.length===0||e.length===1)return!0;let n;for(const r of e){const s=Object.keys(r);if(!n||n.size===0){n=new Set(s);continue}for(const i of s){if(n.has(i))return!1;n.add(i)}}return!0};function $o(t){return typeof t=="object"&&t!==null}function zn(t){if(!$o(t)||Object.prototype.toString.call(t)!=="[object Object]")return!1;if(Object.getPrototypeOf(t)===null)return!0;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}const Bo=(t,e)=>{if(t.startsWith("RS")||t.startsWith("PS")){const{modulusLength:n}=e.algorithm;if(typeof n!="number"||n<2048)throw new TypeError(`${t} requires key modulusLength to be 2048 bits or larger`)}};function he(t){return zn(t)&&typeof t.kty=="string"}function jo(t){return t.kty!=="oct"&&typeof t.d=="string"}function Ho(t){return t.kty!=="oct"&&typeof t.d>"u"}function Ko(t){return he(t)&&t.kty==="oct"&&typeof t.k=="string"}function qo(t){let e,n;switch(t.kty){case"RSA":{switch(t.alg){case"PS256":case"PS384":case"PS512":e={name:"RSA-PSS",hash:`SHA-${t.alg.slice(-3)}`},n=t.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":e={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${t.alg.slice(-3)}`},n=t.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":e={name:"RSA-OAEP",hash:`SHA-${parseInt(t.alg.slice(-3),10)||1}`},n=t.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new M('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"EC":{switch(t.alg){case"ES256":e={name:"ECDSA",namedCurve:"P-256"},n=t.d?["sign"]:["verify"];break;case"ES384":e={name:"ECDSA",namedCurve:"P-384"},n=t.d?["sign"]:["verify"];break;case"ES512":e={name:"ECDSA",namedCurve:"P-521"},n=t.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":e={name:"ECDH",namedCurve:t.crv},n=t.d?["deriveBits"]:[];break;default:throw new M('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"OKP":{switch(t.alg){case"EdDSA":e={name:t.crv},n=t.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":e={name:t.crv},n=t.d?["deriveBits"]:[];break;default:throw new M('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}default:throw new M('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}return{algorithm:e,keyUsages:n}}const Jo=async t=>{if(!t.alg)throw new TypeError('"alg" argument is required when "jwk.alg" is not present');const{algorithm:e,keyUsages:n}=qo(t),r=[e,t.ext??!1,t.key_ops??n],s={...t};return delete s.alg,delete s.use,Be.subtle.importKey("jwk",s,...r)},Vn=t=>St(t);let G,X;const Gn=t=>t?.[Symbol.toStringTag]==="KeyObject",Ie=async(t,e,n,r,s=!1)=>{let i=t.get(e);if(i?.[r])return i[r];const o=await Jo({...n,alg:r});return s&&Object.freeze(e),i?i[r]=o:t.set(e,{[r]:o}),o},Wo=(t,e)=>{if(Gn(t)){let n=t.export({format:"jwk"});return delete n.d,delete n.dp,delete n.dq,delete n.p,delete n.q,delete n.qi,n.k?Vn(n.k):(X||(X=new WeakMap),Ie(X,t,n,e))}return he(t)?t.k?St(t.k):(X||(X=new WeakMap),Ie(X,t,t,e,!0)):t},zo=(t,e)=>{if(Gn(t)){let n=t.export({format:"jwk"});return n.k?Vn(n.k):(G||(G=new WeakMap),Ie(G,t,n,e))}return he(t)?t.k?St(t.k):(G||(G=new WeakMap),Ie(G,t,t,e,!0)):t},Vo={normalizePublicKey:Wo,normalizePrivateKey:zo},K=(t,e,n=0)=>{n===0&&(e.unshift(e.length),e.unshift(6));const r=t.indexOf(e[0],n);if(r===-1)return!1;const s=t.subarray(r,r+e.length);return s.length!==e.length?!1:s.every((i,o)=>i===e[o])||K(t,e,r+1)},Vt=t=>{switch(!0){case K(t,[42,134,72,206,61,3,1,7]):return"P-256";case K(t,[43,129,4,0,34]):return"P-384";case K(t,[43,129,4,0,35]):return"P-521";case K(t,[43,101,110]):return"X25519";case K(t,[43,101,111]):return"X448";case K(t,[43,101,112]):return"Ed25519";case K(t,[43,101,113]):return"Ed448";default:throw new M("Invalid or unsupported EC Key Curve or OKP Key Sub Type")}},Go=async(t,e,n,r,s)=>{let i,o;const a=new Uint8Array(atob(n.replace(t,"")).split("").map(l=>l.charCodeAt(0)));switch(r){case"PS256":case"PS384":case"PS512":i={name:"RSA-PSS",hash:`SHA-${r.slice(-3)}`},o=["sign"];break;case"RS256":case"RS384":case"RS512":i={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${r.slice(-3)}`},o=["sign"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":i={name:"RSA-OAEP",hash:`SHA-${parseInt(r.slice(-3),10)||1}`},o=["decrypt","unwrapKey"];break;case"ES256":i={name:"ECDSA",namedCurve:"P-256"},o=["sign"];break;case"ES384":i={name:"ECDSA",namedCurve:"P-384"},o=["sign"];break;case"ES512":i={name:"ECDSA",namedCurve:"P-521"},o=["sign"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{const l=Vt(a);i=l.startsWith("P-")?{name:"ECDH",namedCurve:l}:{name:l},o=["deriveBits"];break}case"EdDSA":i={name:Vt(a)},o=["sign"];break;default:throw new M('Invalid or unsupported "alg" (Algorithm) value')}return Be.subtle.importKey(e,a,i,!1,o)},Xo=(t,e,n)=>Go(/(?:-----(?:BEGIN|END) PRIVATE KEY-----|\s)/g,"pkcs8",t,e);async function Yo(t,e,n){if(typeof t!="string"||t.indexOf("-----BEGIN PRIVATE KEY-----")!==0)throw new TypeError('"pkcs8" must be PKCS#8 formatted string');return Xo(t,e)}const Q=t=>t?.[Symbol.toStringTag],ut=(t,e,n)=>{if(e.use!==void 0&&e.use!=="sig")throw new TypeError("Invalid key for this operation, when present its use must be sig");if(e.key_ops!==void 0&&e.key_ops.includes?.(n)!==!0)throw new TypeError(`Invalid key for this operation, when present its key_ops must include ${n}`);if(e.alg!==void 0&&e.alg!==t)throw new TypeError(`Invalid key for this operation, when present its alg must be ${t}`);return!0},Qo=(t,e,n,r)=>{if(!(e instanceof Uint8Array)){if(r&&he(e)){if(Ko(e)&&ut(t,e,n))return;throw new TypeError('JSON Web Key for symmetric algorithms must have JWK "kty" (Key Type) equal to "oct" and the JWK "k" (Key Value) present')}if(!Wn(e))throw new TypeError(Jn(t,e,...Oe,"Uint8Array",r?"JSON Web Key":null));if(e.type!=="secret")throw new TypeError(`${Q(e)} instances for symmetric algorithms must be of type "secret"`)}},Zo=(t,e,n,r)=>{if(r&&he(e))switch(n){case"sign":if(jo(e)&&ut(t,e,n))return;throw new TypeError("JSON Web Key for this operation be a private JWK");case"verify":if(Ho(e)&&ut(t,e,n))return;throw new TypeError("JSON Web Key for this operation be a public JWK")}if(!Wn(e))throw new TypeError(Jn(t,e,...Oe,r?"JSON Web Key":null));if(e.type==="secret")throw new TypeError(`${Q(e)} instances for asymmetric algorithms must not be of type "secret"`);if(n==="sign"&&e.type==="public")throw new TypeError(`${Q(e)} instances for asymmetric algorithm signing must be of type "private"`);if(n==="decrypt"&&e.type==="public")throw new TypeError(`${Q(e)} instances for asymmetric algorithm decryption must be of type "private"`);if(e.algorithm&&n==="verify"&&e.type==="private")throw new TypeError(`${Q(e)} instances for asymmetric algorithm verifying must be of type "public"`);if(e.algorithm&&n==="encrypt"&&e.type==="private")throw new TypeError(`${Q(e)} instances for asymmetric algorithm encryption must be of type "public"`)};function Xn(t,e,n,r){e.startsWith("HS")||e==="dir"||e.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(e)?Qo(e,n,r,t):Zo(e,n,r,t)}Xn.bind(void 0,!1);const ea=Xn.bind(void 0,!0);function ta(t,e,n,r,s){if(s.crit!==void 0&&r?.crit===void 0)throw new t('"crit" (Critical) Header Parameter MUST be integrity protected');if(!r||r.crit===void 0)return new Set;if(!Array.isArray(r.crit)||r.crit.length===0||r.crit.some(o=>typeof o!="string"||o.length===0))throw new t('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');let i;n!==void 0?i=new Map([...Object.entries(n),...e.entries()]):i=e;for(const o of r.crit){if(!i.has(o))throw new M(`Extension Header Parameter "${o}" is not recognized`);if(s[o]===void 0)throw new t(`Extension Header Parameter "${o}" is missing`);if(i.get(o)&&r[o]===void 0)throw new t(`Extension Header Parameter "${o}" MUST be integrity protected`)}return new Set(r.crit)}function na(t,e){const n=`SHA-${t.slice(-3)}`;switch(t){case"HS256":case"HS384":case"HS512":return{hash:n,name:"HMAC"};case"PS256":case"PS384":case"PS512":return{hash:n,name:"RSA-PSS",saltLength:t.slice(-3)>>3};case"RS256":case"RS384":case"RS512":return{hash:n,name:"RSASSA-PKCS1-v1_5"};case"ES256":case"ES384":case"ES512":return{hash:n,name:"ECDSA",namedCurve:e.namedCurve};case"EdDSA":return{name:e.name};default:throw new M(`alg ${t} is not supported either by JOSE or your javascript runtime`)}}async function ra(t,e,n){if(e=await Vo.normalizePrivateKey(e,t),Hn(e))return Fo(e,t,n),e;if(e instanceof Uint8Array){if(!t.startsWith("HS"))throw new TypeError(zt(e,...Oe));return Be.subtle.importKey("raw",e,{hash:`SHA-${t.slice(-3)}`,name:"HMAC"},!1,[n])}throw new TypeError(zt(e,...Oe,"Uint8Array","JSON Web Key"))}const q=t=>Math.floor(t.getTime()/1e3),Yn=60,Qn=Yn*60,wt=Qn*24,sa=wt*7,ia=wt*365.25,oa=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i,Ve=t=>{const e=oa.exec(t);if(!e||e[4]&&e[1])throw new TypeError("Invalid time period format");const n=parseFloat(e[2]),r=e[3].toLowerCase();let s;switch(r){case"sec":case"secs":case"second":case"seconds":case"s":s=Math.round(n);break;case"minute":case"minutes":case"min":case"mins":case"m":s=Math.round(n*Yn);break;case"hour":case"hours":case"hr":case"hrs":case"h":s=Math.round(n*Qn);break;case"day":case"days":case"d":s=Math.round(n*wt);break;case"week":case"weeks":case"w":s=Math.round(n*sa);break;default:s=Math.round(n*ia);break}return e[1]==="-"||e[4]==="ago"?-s:s},aa=async(t,e,n)=>{const r=await ra(t,e,"sign");Bo(t,r);const s=await Be.subtle.sign(na(t,r.algorithm),r,n);return new Uint8Array(s)};class ca{constructor(e){if(!(e instanceof Uint8Array))throw new TypeError("payload must be an instance of Uint8Array");this._payload=e}setProtectedHeader(e){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setUnprotectedHeader(e){if(this._unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}async sign(e,n){if(!this._protectedHeader&&!this._unprotectedHeader)throw new Y("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!Mo(this._protectedHeader,this._unprotectedHeader))throw new Y("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");const r={...this._protectedHeader,...this._unprotectedHeader},s=ta(Y,new Map([["b64",!0]]),n?.crit,this._protectedHeader,r);let i=!0;if(s.has("b64")&&(i=this._protectedHeader.b64,typeof i!="boolean"))throw new Y('The "b64" (base64url-encode payload) Header Parameter must be a boolean');const{alg:o}=r;if(typeof o!="string"||!o)throw new Y('JWS "alg" (Algorithm) Header Parameter missing or invalid');ea(o,e,"sign");let a=this._payload;i&&(a=Z.encode(We(a)));let l;this._protectedHeader?l=Z.encode(We(JSON.stringify(this._protectedHeader))):l=Z.encode("");const u=wo(l,Z.encode("."),a),c=await aa(o,e,u),f={signature:We(c),payload:""};return i&&(f.payload=ct.decode(a)),this._unprotectedHeader&&(f.header=this._unprotectedHeader),this._protectedHeader&&(f.protected=ct.decode(l)),f}}class ua{constructor(e){this._flattened=new ca(e)}setProtectedHeader(e){return this._flattened.setProtectedHeader(e),this}async sign(e,n){const r=await this._flattened.sign(e,n);if(r.payload===void 0)throw new TypeError("use the flattened module for creating JWS with b64: false");return`${r.protected}.${r.payload}.${r.signature}`}}function J(t,e){if(!Number.isFinite(e))throw new TypeError(`Invalid ${t} input`);return e}class la{constructor(e={}){if(!zn(e))throw new TypeError("JWT Claims Set MUST be an object");this._payload=e}setIssuer(e){return this._payload={...this._payload,iss:e},this}setSubject(e){return this._payload={...this._payload,sub:e},this}setAudience(e){return this._payload={...this._payload,aud:e},this}setJti(e){return this._payload={...this._payload,jti:e},this}setNotBefore(e){return typeof e=="number"?this._payload={...this._payload,nbf:J("setNotBefore",e)}:e instanceof Date?this._payload={...this._payload,nbf:J("setNotBefore",q(e))}:this._payload={...this._payload,nbf:q(new Date)+Ve(e)},this}setExpirationTime(e){return typeof e=="number"?this._payload={...this._payload,exp:J("setExpirationTime",e)}:e instanceof Date?this._payload={...this._payload,exp:J("setExpirationTime",q(e))}:this._payload={...this._payload,exp:q(new Date)+Ve(e)},this}setIssuedAt(e){return typeof e>"u"?this._payload={...this._payload,iat:q(new Date)}:e instanceof Date?this._payload={...this._payload,iat:J("setIssuedAt",q(e))}:typeof e=="string"?this._payload={...this._payload,iat:J("setIssuedAt",q(new Date)+Ve(e))}:this._payload={...this._payload,iat:J("setIssuedAt",e)},this}}class da extends la{setProtectedHeader(e){return this._protectedHeader=e,this}async sign(e,n){const r=new ua(Z.encode(JSON.stringify(this._payload)));if(r.setProtectedHeader(this._protectedHeader),Array.isArray(this._protectedHeader?.crit)&&this._protectedHeader.crit.includes("b64")&&this._protectedHeader.b64===!1)throw new Kn("JWTs MUST NOT use unencoded payload");return r.sign(e,n)}}const fa=t=>!!(t&&typeof t=="object"&&"access_token"in t&&"expires_in"in t&&typeof t.access_token=="string"&&typeof t.expires_in=="number"),ha=t=>typeof t.text=="function";function pa(t){const e={};if(!t)return{};if(ma(t)){for(const[n,r]of t.entries())e[n.toLowerCase()]=r;return e}for(const[n,r]of Object.entries(t))e[n.toLowerCase()]=r;return e}function ma(t){return typeof t=="object"&&t!==null&&"entries"in Object(t)&&typeof Object(t).entries=="function"}class ga{alg="RS256";grantType="client_credentials";clientAssertionType="urn:ietf:params:oauth:client-assertion-type:jwt-bearer";clientId;clientKey;keyId;scope;authServer;httpClient;maxRetries;clockSkewInSeconds=0;accessToken;tokenEmitter=new fe;retryCount;pollerTimer;constructor(e){this.keyId=e.keyId,this.clientId=e.clientId,this.clientKey=e.clientKey,this.authServer=e.authServer??"https://oauth2.segment.io",this.scope=e.scope??"tracking_api:write",this.httpClient=e.httpClient,this.maxRetries=e.maxRetries,this.tokenEmitter.on("access_token",n=>{"token"in n&&(this.accessToken=n.token)}),this.retryCount=0}stopPoller(){clearTimeout(this.pollerTimer)}async pollerLoop(){let e=25,n;try{n=await this.requestAccessToken()}catch(s){return this.handleTransientError({error:s})}if(!ha(n))return this.handleInvalidCustomResponse();const r=pa(n.headers);if(r.date&&this.updateClockSkew(Date.parse(r.date)),n.status===200)try{const s=await n.text(),i=JSON.parse(s);if(!fa(i))throw new Error("Response did not contain a valid access_token and expires_in");return i.expires_at=Math.round(Date.now()/1e3)+i.expires_in,this.tokenEmitter.emit("access_token",{token:i}),this.retryCount=0,e=i.expires_in/2*1e3,this.queueNextPoll(e)}catch(s){return this.handleTransientError({error:s,forceEmitError:!0})}else return n.status===429?await this.handleRateLimited(n,r,e):[400,401,415].includes(n.status)?this.handleUnrecoverableErrors(n):this.handleTransientError({error:new Error(`[${n.status}] ${n.statusText}`)})}handleTransientError({error:e,forceEmitError:n}){this.incrementRetries({error:e,forceEmitError:n});const r=bt({attempt:this.retryCount,minTimeout:25,maxTimeout:1e3});this.queueNextPoll(r)}handleInvalidCustomResponse(){this.tokenEmitter.emit("access_token",{error:new Error("HTTPClient does not implement response.text method")})}async handleRateLimited(e,n,r){if(this.incrementRetries({error:new Error(`[${e.status}] ${e.statusText}`)}),n["x-ratelimit-reset"]){const s=parseInt(n["x-ratelimit-reset"],10);isFinite(s)?r=s-Date.now()+this.clockSkewInSeconds*1e3:r=5*1e3,await $n(r),r=0}this.queueNextPoll(r)}handleUnrecoverableErrors(e){this.retryCount=0,this.tokenEmitter.emit("access_token",{error:new Error(`[${e.status}] ${e.statusText}`)}),this.stopPoller()}updateClockSkew(e){this.clockSkewInSeconds=(Date.now()-e)/1e3}incrementRetries({error:e,forceEmitError:n}){this.retryCount++,(n||this.retryCount%this.maxRetries===0)&&(this.retryCount=0,this.tokenEmitter.emit("access_token",{error:e}))}queueNextPoll(e){this.pollerTimer=setTimeout(()=>this.pollerLoop(),e),this.pollerTimer.unref&&this.pollerTimer.unref()}async requestAccessToken(){const s=$e(),i=Math.round(Date.now()/1e3)-this.clockSkewInSeconds,o={iss:this.clientId,sub:this.clientId,aud:this.authServer,iat:i-5,exp:i+55,jti:s},a=await Yo(this.clientKey,"RS256"),l=await new da(o).setProtectedHeader({alg:this.alg,kid:this.keyId,typ:"JWT"}).sign(a),u=`grant_type=${this.grantType}&client_assertion_type=${this.clientAssertionType}&client_assertion=${l}&scope=${this.scope}`,f={method:"POST",url:`${this.authServer}/token`,body:u,headers:{"Content-Type":"application/x-www-form-urlencoded"},httpRequestTimeout:1e4};return this.httpClient.makeRequest(f)}async getAccessToken(){return this.isValidToken(this.accessToken)?this.accessToken:(this.stopPoller(),this.pollerLoop().catch(()=>{}),new Promise((e,n)=>{this.tokenEmitter.once("access_token",r=>{"token"in r?e(r.token):n(r.error)})}))}clearToken(){this.accessToken=void 0}isValidToken(e){return typeof e<"u"&&e!==null&&e.expires_in<Date.now()/1e3}}function ya(t){return new Promise(e=>setTimeout(e,t))}function oe(){}class _a{pendingFlushTimeout;_batch;_flushInterval;_flushAt;_maxRetries;_url;_flushPendingItemsCount;_httpRequestTimeout;_emitter;_disable;_httpClient;_writeKey;_tokenManager;constructor({host:e,path:n,maxRetries:r,flushAt:s,flushInterval:i,writeKey:o,httpRequestTimeout:a,httpClient:l,disable:u,oauthSettings:c},f){this._emitter=f,this._maxRetries=r,this._flushAt=Math.max(s,1),this._flushInterval=i,this._url=bo(e??"https://api.segment.io",n??"/v1/batch"),this._httpRequestTimeout=a??1e4,this._disable=!!u,this._httpClient=l,this._writeKey=o,c&&(this._tokenManager=new ga({...c,httpClient:c.httpClient??l,maxRetries:c.maxRetries??r}))}createBatch(){this.pendingFlushTimeout&&clearTimeout(this.pendingFlushTimeout);const e=new So(this._flushAt);return this._batch=e,this.pendingFlushTimeout=setTimeout(()=>{e===this._batch&&(this._batch=void 0),this.pendingFlushTimeout=void 0,e.length&&this.send(e).catch(oe)},this._flushInterval),e}clearBatch(){this.pendingFlushTimeout&&clearTimeout(this.pendingFlushTimeout),this._batch=void 0}flush(e){if(!e){this._tokenManager&&this._tokenManager.stopPoller();return}if(this._flushPendingItemsCount=e,!this._batch)return;this._batch.length===e&&(this.send(this._batch).catch(oe).finally(()=>{this._tokenManager&&this._tokenManager.stopPoller()}),this.clearBatch())}enqueue(e){const n=this._batch??this.createBatch(),{promise:r,resolve:s}=to(),i={context:e,resolver:s};if(n.tryAdd(i).success){const u=n.length===this._flushPendingItemsCount;return(n.length===this._flushAt||u)&&(this.send(n).catch(oe),this.clearBatch()),r}n.length&&(this.send(n).catch(oe),this.clearBatch());const a=this.createBatch(),l=a.tryAdd(i);return l.success?(a.length===this._flushPendingItemsCount&&(this.send(a).catch(oe),this.clearBatch()),r):(e.setFailedDelivery({reason:new Error(l.message)}),Promise.resolve(e))}async send(e){this._flushPendingItemsCount&&(this._flushPendingItemsCount-=e.length);const n=e.getEvents(),r=this._maxRetries+1;let s=0;for(;s<r;){s++;let i,o;try{if(this._disable)return e.resolveEvents();let a;if(this._tokenManager){const f=await this._tokenManager.getAccessToken();f&&f.access_token&&(a=`Bearer ${f.access_token}`)}const l={"Content-Type":"application/json","User-Agent":"analytics-node-next/latest",...a?{Authorization:a}:{}},u={url:this._url,method:"POST",headers:l,body:JSON.stringify({batch:n,writeKey:this._writeKey,sentAt:new Date}),httpRequestTimeout:this._httpRequestTimeout};this._emitter.emit("http_request",{body:u.body,method:u.method,url:u.url,headers:u.headers});const c=await this._httpClient.makeRequest(u);if(c.status>=200&&c.status<300){e.resolveEvents();return}else if(this._tokenManager&&(c.status===400||c.status===401||c.status===403))this._tokenManager.clearToken(),o=new Error(`[${c.status}] ${c.statusText}`);else if(c.status===400){Gt(e,new Error(`[${c.status}] ${c.statusText}`));return}else if(c.status===429){if(c.headers&&"x-ratelimit-reset"in c.headers){const f=parseInt(c.headers["x-ratelimit-reset"],10);isFinite(f)&&(i=f-Date.now())}o=new Error(`[${c.status}] ${c.statusText}`)}else o=new Error(`[${c.status}] ${c.statusText}`)}catch(a){o=a}if(s===r){Gt(e,o);return}await ya(i||bt({attempt:s,minTimeout:25,maxTimeout:1e3}))}}}function Gt(t,e){t.getContexts().forEach(n=>n.setFailedDelivery({reason:e})),t.resolveEvents()}var Xt={};const Zn=()=>typeof process=="object"&&process&&typeof Xt=="object"&&Xt&&typeof process.version=="string"?"node":typeof window=="object"?"browser":typeof WebSocketPair<"u"?"cloudflare-worker":typeof EdgeRuntime=="string"?"vercel-edge":typeof WorkerGlobalScope<"u"&&typeof importScripts=="function"?"web-worker":"unknown";function ba(t){t.updateEvent("context.library.name","@segment/analytics-node"),t.updateEvent("context.library.version",jn);const e=Zn();e==="node"&&t.updateEvent("_metadata.nodeVersion",process.version),t.updateEvent("_metadata.jsRuntime",e)}function Sa(t){function e(n){return ba(n),t.enqueue(n)}return{name:"Segment.io",type:"destination",version:"1.0.0",isLoaded:()=>!0,load:()=>Promise.resolve(),alias:e,group:e,identify:e,page:e,screen:e,track:e}}const wa=(t,e)=>{const n=new _a(t,e);return{publisher:n,plugin:Sa(n)}},Ea=()=>`node-next-${Date.now()}-${$e()}`;class va extends Zi{constructor(){super({createMessageId:Ea,onFinishedEvent:e=>{qi(e)}})}}class lt extends Pe{static system(){return new this({type:"track",event:"system"})}}const Ta=t=>e=>{const n=e.failedDelivery();return t(n?n.reason:void 0,e)},Ca=async(t,e,n,r)=>{try{const s=new lt(t),i=await mo(s,e,n,{...r?{callback:Ta(r)}:{}}),o=i.failedDelivery();o?n.emit("error",{code:"delivery_failure",reason:o.reason,ctx:i}):n.emit(t.type,i)}catch(s){n.emit("error",{code:"unknown",reason:s})}};class Aa extends fe{}class Ra extends no{constructor(){super(1,[])}getAttempts(e){return e.attempts??0}updateAttempts(e){return e.attempts=this.getAttempts(e)+1,this.getAttempts(e)}}class Pa extends ho{constructor(){super(new Ra)}}class Oa{onabort=null;aborted=!1;eventEmitter=new fe;toString(){return"[object AbortSignal]"}get[Symbol.toStringTag](){return"AbortSignal"}removeEventListener(...e){this.eventEmitter.off(...e)}addEventListener(...e){this.eventEmitter.on(...e)}dispatchEvent(e){const n={type:e,target:this},r=`on${e}`;typeof this[r]=="function"&&this[r](n),this.eventEmitter.emit(e,n)}}let Ia=class{signal=new Oa;abort(){this.signal.aborted||(this.signal.aborted=!0,this.signal.dispatchEvent("abort"))}toString(){return"[object AbortController]"}get[Symbol.toStringTag](){return"AbortController"}};const xa=t=>{if(Zn()==="cloudflare-worker")return[];const e=new(globalThis.AbortController||Ia),n=setTimeout(()=>{e.abort()},t);return n?.unref?.(),[e.signal,n]},ka="modulepreload",Na=function(t){return"/"+t},Yt={},Da=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){let u=function(c){return Promise.all(c.map(f=>Promise.resolve(f).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};var o=u;document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=a?.nonce||a?.getAttribute("nonce");s=u(n.map(c=>{if(c=Na(c),c in Yt)return;Yt[c]=!0;const f=c.endsWith(".css"),_=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${_}`))return;const m=document.createElement("link");if(m.rel=f?"stylesheet":ka,f||(m.as="script"),m.crossOrigin="",m.href=c,l&&m.setAttribute("nonce",l),document.head.appendChild(m),f)return new Promise((h,p)=>{m.addEventListener("load",h),m.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return s.then(a=>{for(const l of a||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})},La=async(...t)=>{if(globalThis.fetch)return globalThis.fetch(...t);if(typeof EdgeRuntime!="string")return(await Da(async()=>{const{default:e}=await import("./chunks/index-n8GDgY1e.js");return{default:e}},[])).default(...t);throw new Error("Invariant: an edge runtime that does not support fetch should not exist")};class Qt{_fetch;constructor(e){this._fetch=e??La}async makeRequest(e){const[n,r]=xa(e.httpRequestTimeout),s={url:e.url,method:e.method,headers:e.headers,body:e.body,signal:n};return this._fetch(e.url,s).finally(()=>clearTimeout(r))}}class Ua extends Aa{_eventFactory;_isClosed=!1;_pendingEvents=0;_closeAndFlushDefaultTimeout;_publisher;_isFlushing=!1;_queue;ready;constructor(e){super(),yo(e),this._eventFactory=new va,this._queue=new Pa;const n=e.flushInterval??1e4;this._closeAndFlushDefaultTimeout=n*1.25;const{plugin:r,publisher:s}=wa({writeKey:e.writeKey,host:e.host,path:e.path,maxRetries:e.maxRetries??3,flushAt:e.flushAt??e.maxEventsInBatch??15,httpRequestTimeout:e.httpRequestTimeout,disable:e.disable,flushInterval:n,httpClient:typeof e.httpClient=="function"?new Qt(e.httpClient):e.httpClient??new Qt,oauthSettings:e.oauthSettings},this);this._publisher=s,this.ready=this.register(r).then(()=>{}),this.emit("initialize",e),go(this)}get VERSION(){return jn}closeAndFlush({timeout:e=this._closeAndFlushDefaultTimeout}={}){return this.flush({timeout:e,close:!0})}async flush({timeout:e,close:n=!1}={}){if(this._isFlushing){console.warn("Overlapping flush calls detected. Please wait for the previous flush to finish before calling .flush again");return}else this._isFlushing=!0;n&&(this._isClosed=!0),this._publisher.flush(this._pendingEvents);const r=new Promise(s=>{this._pendingEvents?this.once("drained",()=>{s()}):s()}).finally(()=>{this._isFlushing=!1});return e?Mn(r,e).catch(()=>{}):r}_dispatch(e,n){if(this._isClosed){this.emit("call_after_close",e);return}this._pendingEvents++,Ca(e,this._queue,this,n).catch(r=>r).finally(()=>{this._pendingEvents--,this._pendingEvents||this.emit("drained")})}alias({userId:e,previousId:n,context:r,timestamp:s,integrations:i,messageId:o},a){const l=this._eventFactory.alias(e,n,{context:r,integrations:i,timestamp:s,messageId:o});this._dispatch(l,a)}group({timestamp:e,groupId:n,userId:r,anonymousId:s,traits:i={},context:o,integrations:a,messageId:l},u){const c=this._eventFactory.group(n,i,{context:o,anonymousId:s,userId:r,timestamp:e,integrations:a,messageId:l});this._dispatch(c,u)}identify({userId:e,anonymousId:n,traits:r={},context:s,timestamp:i,integrations:o,messageId:a},l){const u=this._eventFactory.identify(e,r,{context:s,anonymousId:n,userId:e,timestamp:i,integrations:o,messageId:a});this._dispatch(u,l)}page({userId:e,anonymousId:n,category:r,name:s,properties:i,context:o,timestamp:a,integrations:l,messageId:u},c){const f=this._eventFactory.page(r??null,s??null,i,{context:o,anonymousId:n,userId:e,timestamp:a,integrations:l,messageId:u});this._dispatch(f,c)}screen({userId:e,anonymousId:n,category:r,name:s,properties:i,context:o,timestamp:a,integrations:l,messageId:u},c){const f=this._eventFactory.screen(r??null,s??null,i,{context:o,anonymousId:n,userId:e,timestamp:a,integrations:l,messageId:u});this._dispatch(f,c)}track({userId:e,anonymousId:n,event:r,properties:s,context:i,timestamp:o,integrations:a,messageId:l},u){const c=this._eventFactory.track(r,s,{context:i,userId:e,anonymousId:n,timestamp:o,integrations:a,messageId:l});this._dispatch(c,u)}register(...e){return this._queue.criticalTasks.run(async()=>{const n=lt.system(),r=e.map(s=>this._queue.register(n,s,this));await Promise.all(r),this.emit("register",e.map(s=>s.name))})}async deregister(...e){const n=lt.system(),r=e.map(s=>{const i=this._queue.plugins.find(o=>o.name===s);if(i)return this._queue.deregister(n,i,this);n.log("warn",`plugin ${s} not found`)});await Promise.all(r),this.emit("deregister",e)}}const{version:Fa}=chrome.runtime.getManifest(),[Ma,$a,Ba,Zt]=Fa.split("."),en=`${Ma}.${$a}.${Ba}${Zt?`+${Zt}`:""}`,ja=()=>{let t,e=Promise.all([Ge(),Ha()]).then(([i,o])=>{n.anonymousId=i,t=new Ua({writeKey:"rH2YGeFIvSPYz9snRzhvWgiispJa1Rth"}),t.register({name:"Add-ClientType-Info",type:"before",version:"1.0.0",isLoaded:()=>!0,load:()=>Promise.resolve(),track:a=>(a.event.properties={...a.event.properties,clientType:"extension",version:en,installID:o},a.event.context={...a.event.context,channel:"extension"},a),page:a=>(a.event.properties={...a.event.properties,clientType:"extension",version:en,installID:o},a.event.context={...a.event.context,channel:"extension"},a)}),e=void 0});const n={};chrome.runtime.onMessage.addListener(async i=>{e&&await e,!(!n.user&&!n.anonymousId)&&i.type==="analytics-track"&&t?.track({...i.params,userId:n.user?.id,anonymousId:n.anonymousId})}),Ka(dt,async()=>{n.anonymousId=await Ge()});const r={};async function s(i,o){const a=o?.id??"anonymous",l=`firstInstall:${a}`;r[a]=r[a]??(await chrome.storage.local.get(l))[l],!r[a]&&(await chrome.storage.local.set({[l]:!0}),r[a]=!0,o&&t?.identify({userId:o?.id.toString(),anonymousId:i,traits:{email:o.email,name:o.first_name,extension_installed:!0}}),t?.track({event:"Extension Installed",userId:o?.id,anonymousId:i}))}return async function(o,a){n.user=o;const l=await Ge();n.anonymousId=l,o&&!a&&t?.identify({userId:o?.id.toString(),anonymousId:l,traits:{email:o.email,name:o.first_name,extension_installed:!0}}),s(l,o)}};async function Ha(){const t=(await chrome.storage.local.get("installID"))?.installID;return t||await chrome.storage.local.set({installID:crypto.randomUUID()}),t}const dt="ajs_anonymous_id";async function Ge(){const t=await chrome.cookies.get({url:P,name:dt});if(!t?.value){const e=crypto.randomUUID();return await chrome.cookies.set({url:P,name:dt,value:e,path:"/",secure:P.startsWith("https")}),e}return t?.value}function Ka(t,e){chrome.cookies.onChanged.addListener(async n=>{(P.endsWith(n.cookie.domain)||P.includes("localhost")&&n.cookie.domain==="localhost")&&n.cookie.name===t&&e()})}const qa=Object.prototype.toString;function Ja(t,e){return qa.call(t)===`[object ${e}]`}function Wa(t){return Ja(t,"Object")}function za(t){return!!(t&&t.then&&typeof t.then=="function")}const ae="8.37.1",$=globalThis;function Et(t,e,n){const r=$,s=r.__SENTRY__=r.__SENTRY__||{},i=s[ae]=s[ae]||{};return i[t]||(i[t]=e())}const er=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,Va="Sentry Logger ",tn=["debug","info","warn","error","log","assert","trace"],nn={};function Ga(t){if(!("console"in $))return t();const e=$.console,n={},r=Object.keys(nn);r.forEach(s=>{const i=nn[s];n[s]=e[s],e[s]=i});try{return t()}finally{r.forEach(s=>{e[s]=n[s]})}}function Xa(){let t=!1;const e={enable:()=>{t=!0},disable:()=>{t=!1},isEnabled:()=>t};return er?tn.forEach(n=>{e[n]=(...r)=>{t&&Ga(()=>{$.console[n](`${Va}[${n}]:`,...r)})}}):tn.forEach(n=>{e[n]=()=>{}}),e}const ve=Et("logger",Xa);function Ya(t,e,n){try{Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0})}catch{er&&ve.log(`Failed to add non-enumerable property "${e}" to object`,t)}}const tr=1e3;function nr(){return Date.now()/tr}function Qa(){const{performance:t}=$;if(!t||!t.now)return nr;const e=Date.now()-t.now(),n=t.timeOrigin==null?e:t.timeOrigin;return()=>(n+t.now())/tr}const Za=Qa();(()=>{const{performance:t}=$;if(!t||!t.now)return;const e=3600*1e3,n=t.now(),r=Date.now(),s=t.timeOrigin?Math.abs(t.timeOrigin+n-r):e,i=s<e,o=t.timing&&t.timing.navigationStart,l=typeof o=="number"?Math.abs(o+n-r):e,u=l<e;return i||u?s<=l?t.timeOrigin:o:r})();function ee(){const t=$,e=t.crypto||t.msCrypto;let n=()=>Math.random()*16;try{if(e&&e.randomUUID)return e.randomUUID().replace(/-/g,"");e&&e.getRandomValues&&(n=()=>{const r=new Uint8Array(1);return e.getRandomValues(r),r[0]})}catch{}return("10000000100040008000"+1e11).replace(/[018]/g,r=>(r^(n()&15)>>r/4).toString(16))}function rn(){return{traceId:ee(),spanId:ee().substring(16)}}function rr(){return vt($),$}function vt(t){const e=t.__SENTRY__=t.__SENTRY__||{};return e.version=e.version||ae,e[ae]=e[ae]||{}}function ec(t,e={}){if(e.user&&(!t.ipAddress&&e.user.ip_address&&(t.ipAddress=e.user.ip_address),!t.did&&!e.did&&(t.did=e.user.id||e.user.email||e.user.username)),t.timestamp=e.timestamp||Za(),e.abnormal_mechanism&&(t.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(t.ignoreDuration=e.ignoreDuration),e.sid&&(t.sid=e.sid.length===32?e.sid:ee()),e.init!==void 0&&(t.init=e.init),!t.did&&e.did&&(t.did=`${e.did}`),typeof e.started=="number"&&(t.started=e.started),t.ignoreDuration)t.duration=void 0;else if(typeof e.duration=="number")t.duration=e.duration;else{const n=t.timestamp-t.started;t.duration=n>=0?n:0}e.release&&(t.release=e.release),e.environment&&(t.environment=e.environment),!t.ipAddress&&e.ipAddress&&(t.ipAddress=e.ipAddress),!t.userAgent&&e.userAgent&&(t.userAgent=e.userAgent),typeof e.errors=="number"&&(t.errors=e.errors),e.status&&(t.status=e.status)}const ft="_sentrySpan";function sn(t,e){e?Ya(t,ft,e):delete t[ft]}function on(t){return t[ft]}const tc=100;class Tt{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=rn()}clone(){const e=new Tt;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._requestSession=this._requestSession,e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e._lastEventId=this._lastEventId,sn(e,on(this)),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&ec(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,n){return this._tags={...this._tags,[e]:n},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,n){return this._extra={...this._extra,[e]:n},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,n){return n===null?delete this._contexts[e]:this._contexts[e]=n,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const n=typeof e=="function"?e(this):e,[r,s]=n instanceof ue?[n.getScopeData(),n.getRequestSession()]:Wa(n)?[e,e.requestSession]:[],{tags:i,extra:o,user:a,contexts:l,level:u,fingerprint:c=[],propagationContext:f}=r||{};return this._tags={...this._tags,...i},this._extra={...this._extra,...o},this._contexts={...this._contexts,...l},a&&Object.keys(a).length&&(this._user=a),u&&(this._level=u),c.length&&(this._fingerprint=c),f&&(this._propagationContext=f),s&&(this._requestSession=s),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._session=void 0,sn(this,void 0),this._attachments=[],this._propagationContext=rn(),this._notifyScopeListeners(),this}addBreadcrumb(e,n){const r=typeof n=="number"?n:tc;if(r<=0)return this;const s={timestamp:nr(),...e},i=this._breadcrumbs;return i.push(s),this._breadcrumbs=i.length>r?i.slice(-r):i,this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:on(this)}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...e},this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}captureException(e,n){const r=n&&n.event_id?n.event_id:ee();if(!this._client)return ve.warn("No client configured on scope - will not capture exception!"),r;const s=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:s,...n,event_id:r},this),r}captureMessage(e,n,r){const s=r&&r.event_id?r.event_id:ee();if(!this._client)return ve.warn("No client configured on scope - will not capture message!"),s;const i=new Error(e);return this._client.captureMessage(e,n,{originalException:e,syntheticException:i,...r,event_id:s},this),s}captureEvent(e,n){const r=n&&n.event_id?n.event_id:ee();return this._client?(this._client.captureEvent(e,{...n,event_id:r},this),r):(ve.warn("No client configured on scope - will not capture event!"),r)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}}const ue=Tt;function nc(){return Et("defaultCurrentScope",()=>new ue)}function rc(){return Et("defaultIsolationScope",()=>new ue)}class sc{constructor(e,n){let r;e?r=e:r=new ue;let s;n?s=n:s=new ue,this._stack=[{scope:r}],this._isolationScope=s}withScope(e){const n=this._pushScope();let r;try{r=e(n)}catch(s){throw this._popScope(),s}return za(r)?r.then(s=>(this._popScope(),s),s=>{throw this._popScope(),s}):(this._popScope(),r)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e}_popScope(){return this._stack.length<=1?!1:!!this._stack.pop()}}function ne(){const t=rr(),e=vt(t);return e.stack=e.stack||new sc(nc(),rc())}function ic(t){return ne().withScope(t)}function oc(t,e){const n=ne();return n.withScope(()=>(n.getStackTop().scope=t,e(t)))}function an(t){return ne().withScope(()=>t(ne().getIsolationScope()))}function ac(){return{withIsolationScope:an,withScope:ic,withSetScope:oc,withSetIsolationScope:(t,e)=>an(e),getCurrentScope:()=>ne().getScope(),getIsolationScope:()=>ne().getIsolationScope()}}function cc(t){const e=vt(t);return e.acs?e.acs:ac()}function uc(){const t=rr();return cc(t).getIsolationScope()}function cn(t){uc().setUser(t)}const lc=async t=>{cn(t?{id:t.id.toString(),email:t.email}:null)},dc=sr({type:"module",main:()=>{ji();const t=ja();Js(),Ws(),zs([t,lc]),Bi(),chrome.action.onClicked.addListener(e=>{e?.id&&Dn.forceShowExtension.send(e.id)}),chrome.runtime.onInstalled.addListener(e=>{e.reason==="install"&&chrome.tabs.create({url:`https://earnbetter.com/app/register/?onboardingType=extensionInstall&redirectPath=${encodeURIComponent("/jobs/?tab=search&autofillSupported=true")}&utm_source=chrome-web-store&utm_medium=extension-install`,active:!0})})}});globalThis.browser?.runtime?.id?globalThis.browser:globalThis.chrome;function _e(t,...e){}const fc={debug:(...t)=>_e(console.debug,...t),log:(...t)=>_e(console.log,...t),warn:(...t)=>_e(console.warn,...t),error:(...t)=>_e(console.error,...t)};let un;try{un=dc.main(),un instanceof Promise&&console.warn("The background's main() function return a promise, but it must be synchronous")}catch(t){throw fc.error("The background crashed on startup!"),t}
